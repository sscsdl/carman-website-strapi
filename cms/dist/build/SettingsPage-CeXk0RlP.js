import{a as p,r as M,j as e,co as g,z as F,dY as r,aI as ae,dZ as H,q as A,p as E,d_ as se,a3 as N,F as O,c$ as f,T as S,I as j,bo as U,Z as w,b2 as te,bh as ne,b3 as B,d$ as $,U as D,cq as z,y as re,b7 as ie,B as le,H as L,D as oe,E as de,e0 as ce,bK as V,o as Q,bD as ue,bL as ge,_ as me,e1 as he,S as xe,bE as fe,X as _,bF as I,bH as je,W as pe,Y as P,P as T,e2 as W,e3 as be,w as ye,cR as Se,e4 as Me,e5 as Ce,L as k,cT as ve,cK as Le,aF as Ae,K as Ee,bp as Ie}from"./strapi-D0ivxu6x.js";const G=a=>a.name!==void 0,q=({disabled:a,variant:n="default"})=>{const{formatMessage:t}=p(),[s,d]=M.useState(!1);return e.jsxs(g.Root,{open:s,onOpenChange:d,children:[e.jsx(g.Trigger,{children:e.jsx(F,{variant:n,disabled:a,startIcon:e.jsx(ae,{}),onClick:()=>d(!0),size:"S",fullWidth:!0,children:t({id:r("Settings.list.actions.add"),defaultMessage:"Add new locale"})})}),e.jsx(Te,{onClose:()=>d(!1)})]})},K=te().shape({code:B().nullable().required({id:"Settings.locales.modal.create.code.error",defaultMessage:"Please select a locale"}),name:B().nullable().max(50,{id:"Settings.locales.modal.create.name.error.min",defaultMessage:"The locale display name can only be less than 50 characters."}).required({id:"Settings.locales.modal.create.name.error.required",defaultMessage:"Please give the locale a display name"}),isDefault:ne()}),Pe={code:"",name:"",isDefault:!1},Te=({onClose:a})=>{const n=H(),{toggleNotification:t}=A(),{_unstableFormatAPIError:s,_unstableFormatValidationErrors:d}=E(),[c]=se(),{formatMessage:l}=p(),i=N("CreateModal",u=>u.refetchPermissions),o=async(u,m)=>{try{const h=await c(u);if("error"in h){G(h.error)&&h.error.name==="ValidationError"?m.setErrors(d(h.error)):t({type:"danger",message:s(h.error)});return}t({type:"success",message:l({id:r("Settings.locales.modal.create.success"),defaultMessage:"Locale successfully added"})}),i(),a()}catch{t({type:"danger",message:l({id:"notification.error",defaultMessage:"An error occurred, please try again"})})}};return e.jsx(g.Content,{children:e.jsxs(O,{method:"POST",initialValues:Pe,validationSchema:K,onSubmit:o,children:[e.jsx(g.Header,{children:e.jsx(g.Title,{children:l({id:r("Settings.list.actions.add"),defaultMessage:"Add new locale"})})}),e.jsx(g.Body,{children:e.jsxs(f.Root,{variant:"simple",defaultValue:"basic",children:[e.jsxs(S,{justifyContent:"space-between",children:[e.jsx(j,{tag:"h2",variant:"beta",id:n,children:l({id:r("Settings.locales.modal.title"),defaultMessage:"Configuration"})}),e.jsxs(f.List,{"aria-labelledby":n,children:[e.jsx(f.Trigger,{value:"basic",children:l({id:r("Settings.locales.modal.base"),defaultMessage:"Basic settings"})}),e.jsx(f.Trigger,{value:"advanced",children:l({id:r("Settings.locales.modal.advanced"),defaultMessage:"Advanced settings"})})]})]}),e.jsx(U,{}),e.jsxs(w,{paddingTop:7,paddingBottom:7,children:[e.jsx(f.Content,{value:"basic",children:e.jsx(Z,{})}),e.jsx(f.Content,{value:"advanced",children:e.jsx(J,{})})]})]})}),e.jsxs(g.Footer,{children:[e.jsx(g.Close,{children:e.jsx(F,{variant:"tertiary",children:l({id:"app.components.Button.cancel",defaultMessage:"Cancel"})})}),e.jsx(Y,{})]})]})})},Y=()=>{const{formatMessage:a}=p(),n=z("SubmitButton",s=>s.isSubmitting),t=z("SubmitButton",s=>s.modified);return e.jsx(F,{type:"submit",startIcon:e.jsx(re,{}),disabled:n||!t,children:a({id:"global.save",defaultMessage:"Save"})})},Z=({mode:a="create"})=>{const{formatMessage:n}=p(),{toggleNotification:t}=A(),{_unstableFormatAPIError:s}=E(),{data:d,error:c}=$();if(M.useEffect(()=>{c&&t({type:"danger",message:s(c)})},[c,s,t]),!Array.isArray(d))return null;const l=d.map(o=>({label:o.name,value:o.code})),i=[{disabled:a!=="create",label:{id:r("Settings.locales.modal.create.code.label"),defaultMessage:"Locales"},name:"code",options:l,placeholder:{id:"components.placeholder.select",defaultMessage:"Select"},required:!0,size:6,type:"enumeration"},{hint:{id:r("Settings.locales.modal.create.name.label.description"),defaultMessage:"Locale will be displayed under that name in the administration panel"},label:{id:r("Settings.locales.modal.create.name.label"),defaultMessage:"Locale display name"},name:"name",required:!0,size:6,type:"string"}].map(o=>({...o,hint:o.hint?n(o.hint):void 0,label:n(o.label),placeholder:o.placeholder?n(o.placeholder):void 0}));return e.jsx(D.Root,{gap:4,children:i.map(({size:o,...u})=>e.jsx(D.Item,{xs:12,m:o,direction:"column",alignItems:"stretch",children:e.jsx(X,{...u})},u.name))})},J=({isDefaultLocale:a})=>{const{formatMessage:n}=p(),t=[{disabled:a,hint:{id:r("Settings.locales.modal.advanced.setAsDefault.hint"),defaultMessage:"One default locale is required, change it by selecting another one"},label:{id:r("Settings.locales.modal.advanced.setAsDefault"),defaultMessage:"Set as default locale"},name:"isDefault",size:6,type:"boolean"}].map(s=>({...s,hint:s.hint?n(s.hint):void 0,label:n(s.label)}));return e.jsx(D.Root,{gap:4,children:t.map(({size:s,...d})=>e.jsx(D.Item,{xs:12,m:s,direction:"column",alignItems:"stretch",children:e.jsx(X,{...d})},d.name))})},X=a=>{switch(a.type){case"enumeration":return e.jsx(De,{...a});default:return e.jsx(ie,{...a})}},De=({disabled:a,hint:n,label:t,name:s,options:d,placeholder:c,required:l})=>{const{value:i,error:o,onChange:u}=le(s),{data:m=[]}=$(),h=x=>{if(Array.isArray(m)){const C=m.find(y=>y.code===x);u(s,x),u("name",C.name)}else u(s,x)};return e.jsxs(L.Root,{error:o,hint:n,name:s,required:l,children:[e.jsx(L.Label,{children:t}),e.jsx(oe,{disabled:a,onChange:h,onClear:()=>h(""),placeholder:c,value:i,autocomplete:{type:"list",filter:"contains"},children:d.map(x=>e.jsx(de,{value:x.value,children:x.label},x.value))}),e.jsx(L.Error,{}),e.jsx(L.Hint,{})]})},Fe=({id:a,name:n})=>{const{formatMessage:t}=p(),{toggleNotification:s}=A(),{_unstableFormatAPIError:d}=E(),[c,l]=M.useState(!1),[i]=ce(),o=async()=>{try{const u=await i(a);if("error"in u){s({type:"danger",message:d(u.error)});return}s({type:"success",message:t({id:r("Settings.locales.modal.delete.success"),defaultMessage:"Deleted locale"})}),l(!1)}catch{s({type:"danger",message:t({id:"notification.error",defaultMessage:"An error occurred, please try again"})})}};return e.jsxs(V.Root,{open:c,onOpenChange:l,children:[e.jsx(V.Trigger,{children:e.jsx(Q,{onClick:()=>l(!0),label:t({id:r("Settings.list.actions.delete"),defaultMessage:"Delete {name} locale"},{name:n}),variant:"ghost",children:e.jsx(ue,{})})}),e.jsx(ge,{onConfirm:o})]})},we=a=>{const{formatMessage:n}=p(),[t,s]=M.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsx(Q,{onClick:()=>s(!0),label:n({id:r("Settings.list.actions.edit"),defaultMessage:"Edit {name} locale"},{name:a.name}),variant:"ghost",children:e.jsx(me,{})}),e.jsx(ee,{...a,open:t,onOpenChange:s})]})},ee=({id:a,code:n,isDefault:t,name:s,open:d,onOpenChange:c})=>{const{toggleNotification:l}=A(),{_unstableFormatAPIError:i,_unstableFormatValidationErrors:o}=E(),u=N("EditModal",y=>y.refetchPermissions),{formatMessage:m}=p(),h=H(),[x]=he(),C=async({code:y,...R},v)=>{try{const b=await x({id:a,...R});if("error"in b){G(b.error)&&b.error.name==="ValidationError"?v.setErrors(o(b.error)):l({type:"danger",message:i(b.error)});return}l({type:"success",message:m({id:r("Settings.locales.modal.edit.success"),defaultMessage:"Locale successfully edited"})}),u(),c(!1)}catch{l({type:"danger",message:m({id:"notification.error",defaultMessage:"An error occurred, please try again"})})}};return e.jsx(g.Root,{open:d,onOpenChange:c,children:e.jsx(g.Content,{children:e.jsxs(O,{method:"PUT",onSubmit:C,initialValues:{code:n,name:s,isDefault:t},validationSchema:K,children:[e.jsx(g.Header,{children:e.jsx(g.Title,{children:m({id:r("Settings.list.actions.edit"),defaultMessage:"Edit a locale"},{name:s})})}),e.jsx(g.Body,{children:e.jsxs(f.Root,{variant:"simple",defaultValue:"basic",children:[e.jsxs(S,{justifyContent:"space-between",children:[e.jsx(j,{tag:"h2",variant:"beta",id:h,children:m({id:r("Settings.locales.modal.title"),defaultMessage:"Configuration"})}),e.jsxs(f.List,{"aria-labelledby":h,children:[e.jsx(f.Trigger,{value:"basic",children:m({id:r("Settings.locales.modal.base"),defaultMessage:"Basic settings"})}),e.jsx(f.Trigger,{value:"advanced",children:m({id:r("Settings.locales.modal.advanced"),defaultMessage:"Advanced settings"})})]})]}),e.jsx(U,{}),e.jsxs(w,{paddingTop:7,paddingBottom:7,children:[e.jsx(f.Content,{value:"basic",children:e.jsx(Z,{mode:"edit"})}),e.jsx(f.Content,{value:"advanced",children:e.jsx(J,{isDefaultLocale:t})})]})]})}),e.jsxs(g.Footer,{children:[e.jsx(g.Close,{children:e.jsx(F,{variant:"tertiary",children:m({id:"app.components.Button.cancel",defaultMessage:"Cancel"})})}),e.jsx(Y,{})]})]})})})},Re=({locales:a=[],canDelete:n,canUpdate:t})=>{const[s,d]=M.useState(),{formatMessage:c}=p(),l=i=>()=>{t&&d(i)};return e.jsxs(xe,{colCount:4,rowCount:a.length+1,children:[e.jsx(fe,{children:e.jsxs(_,{children:[e.jsx(I,{children:e.jsx(j,{variant:"sigma",textColor:"neutral600",children:c({id:r("Settings.locales.row.id"),defaultMessage:"ID"})})}),e.jsx(I,{children:e.jsx(j,{variant:"sigma",textColor:"neutral600",children:c({id:r("Settings.locales.row.displayName"),defaultMessage:"Display name"})})}),e.jsx(I,{children:e.jsx(j,{variant:"sigma",textColor:"neutral600",children:c({id:r("Settings.locales.row.default-locale"),defaultMessage:"Default locale"})})}),e.jsx(I,{children:e.jsx(je,{children:"Actions"})})]})}),e.jsx(pe,{children:a.map(i=>e.jsxs(M.Fragment,{children:[e.jsxs(_,{onClick:l(i.id),style:{cursor:t?"pointer":"default"},children:[e.jsx(P,{children:e.jsx(j,{textColor:"neutral800",children:i.id})}),e.jsx(P,{children:e.jsx(j,{textColor:"neutral800",children:i.name})}),e.jsx(P,{children:e.jsx(j,{textColor:"neutral800",children:i.isDefault?c({id:r("Settings.locales.default"),defaultMessage:"Default"}):null})}),e.jsx(P,{children:e.jsxs(S,{gap:1,justifyContent:"flex-end",onClick:o=>o.stopPropagation(),children:[t&&e.jsx(we,{...i}),n&&!i.isDefault&&e.jsx(Fe,{...i})]})})]}),e.jsx(ee,{...i,onOpenChange:()=>d(void 0),open:s===i.id})]},i.id))})]})},Be=({children:a,error:n})=>{const{_unstableFormatAPIError:t}=E();return n?e.jsx(Ie,{label:t(n),style:{maxWidth:"200px"},children:a}):a},ze=()=>{const{formatMessage:a}=p(),{toggleNotification:n}=A(),{data:t,isLoading:s,error:d}=be(),{isLoading:c,allowedActions:{canUpdate:l,canCreate:i,canDelete:o}}=ye(W),u=Se(),{data:m,isLoading:h,error:x}=Me(),[C]=Ce(),y=async v=>{try{await C({aiLocalizations:v}).unwrap(),n({type:"success",message:a({id:"notification.form.success.fields"})})}catch(b){console.error(b),n({type:"danger",message:a({id:"notification.error",defaultMessage:"An error occurred"})})}};return s||c||h?e.jsx(T.Loading,{}):d||!Array.isArray(t)?e.jsx(T.Error,{}):e.jsxs(T.Main,{tabIndex:-1,children:[e.jsx(k.Header,{primaryAction:e.jsx(q,{disabled:!i}),title:a({id:r("plugin.name"),defaultMessage:"Internationalization"}),subtitle:a({id:r("Settings.list.description"),defaultMessage:"Configure the settings"})}),e.jsxs(k.Content,{children:[u&&e.jsxs(S,{background:"neutral0",padding:6,marginBottom:6,shadow:"filterShadow",hasRadius:!0,children:[e.jsxs(S,{direction:"column",alignItems:"stretch",gap:1,flex:1,children:[e.jsxs(S,{gap:1,children:[e.jsx(w,{color:"alternative700",children:e.jsx(ve,{})}),e.jsx(j,{variant:"delta",tag:"h2",children:a({id:r("Settings.aiLocalizations.label"),defaultMessage:"AI Translations"})})]}),e.jsx(j,{variant:"pi",textColor:"neutral600",fontSize:"14px",children:a({id:r("Settings.aiLocalizations.description"),defaultMessage:"Everytime you save in the Content Manager, our AI will use your default locale to translate all other locales automatically."})})]}),e.jsx(L.Root,{name:"aiLocalizations",minWidth:"200px",children:e.jsx(Be,{error:x,children:e.jsx(Le,{disabled:!!x,checked:m?.data?.aiLocalizations??!1,offLabel:a({id:"app.components.ToggleCheckbox.disabled-label",defaultMessage:"Disabled"}),onLabel:a({id:"app.components.ToggleCheckbox.enabled-label",defaultMessage:"Enabled"}),onChange:v=>y(v.target.checked)})})})]}),t.length>0?e.jsx(Re,{locales:t,canDelete:o,canUpdate:l}):e.jsx(Ae,{icon:e.jsx(Ee,{width:void 0,height:void 0}),content:a({id:r("Settings.list.empty.title"),defaultMessage:"There are no locales"}),action:e.jsx(q,{disabled:!i,variant:"secondary"})})]})]})},_e=()=>e.jsx(T.Protect,{permissions:W.read,children:e.jsx(ze,{})});export{_e as ProtectedSettingsPage,ze as SettingsPage};
