import{a as j,j as e,Z as A,U as c,H as d,cM as o,aW as b,eM as H,aX as x,eN as W,eO as u,cb as O,eP as T,cN as z,b as U,q as _,eQ as $,r as y,L as g,P as q,z as P,cS as B,y as G,bW as F,aH as K,eq as Q,bK as V,bL as X}from"./strapi-D0ivxu6x.js";const Y=({sort:i="",pageSize:t=10,onChange:s})=>{const{formatMessage:n}=j();return e.jsx(A,{background:"neutral0",hasRadius:!0,shadow:"tableShadow",paddingTop:6,paddingBottom:6,paddingLeft:7,paddingRight:7,children:e.jsxs(c.Root,{gap:4,children:[e.jsx(c.Item,{xs:12,m:6,direction:"column",alignItems:"stretch",children:e.jsxs(d.Root,{hint:n({id:o("config.entries.note"),defaultMessage:"Number of assets displayed by default in the Media Library"}),name:"pageSize",children:[e.jsx(d.Label,{children:n({id:o("config.entries.title"),defaultMessage:"Entries per page"})}),e.jsx(b,{onChange:a=>s({target:{name:"pageSize",value:a}}),value:t,children:H.map(a=>e.jsx(x,{value:a,children:a},a))}),e.jsx(d.Hint,{})]})}),e.jsx(c.Item,{xs:12,m:6,direction:"column",alignItems:"stretch",children:e.jsxs(d.Root,{hint:n({id:o("config.note"),defaultMessage:"Note: You can override this value in the media library."}),name:"sort",children:[e.jsx(d.Label,{children:n({id:o("config.sort.title"),defaultMessage:"Default sort order"})}),e.jsx(b,{onChange:a=>s({target:{name:"sort",value:a}}),value:i,"test-sort":i,"data-testid":"sort-select",children:W.map(a=>e.jsx(x,{"data-testid":`sort-option-${a.value}`,value:a.value,children:n({id:o(a.key),defaultMessage:`${a.value}`})},a.key))}),e.jsx(d.Hint,{})]})})]})})},v=`${u}/ON_CHANGE`,D=`${u}/SET_LOADED`,Z=({name:i,value:t})=>({type:v,keys:i,value:t}),J=()=>({type:D}),m={initialData:{},modifiedData:{}},M=i=>({...m,initialData:i,modifiedData:i}),ee=(i=m,t={type:""})=>O(i,s=>{switch(t.type){case v:{"keys"in t&&"value"in t&&t.keys&&z(s,["modifiedData",...t.keys.split(".")],t.value);break}case D:{const n=M(T(s,["modifiedData"],{}));s.initialData=n.initialData,s.modifiedData=n.modifiedData;break}default:return s}}),se=({config:i})=>{const{trackUsage:t}=U(),{formatMessage:s}=j(),{toggleNotification:n}=_(),{mutateConfig:a}=$(),{isLoading:C}=a,[S,h]=y.useState(!1),f=()=>h(r=>!r),[k,L]=y.useReducer(ee,m,()=>M(i)),p=L,{initialData:w,modifiedData:l}=k,E=r=>{r.preventDefault(),f()},N=async()=>{t("willEditMediaLibraryConfig"),await a.mutateAsync(l),h(!1),p(J()),n({type:"success",message:s({id:"notification.form.success.fields",defaultMessage:"Changes saved"})})},R=({target:{name:r,value:I}})=>{p(Z({name:r,value:I}))};return e.jsx(g.Root,{children:e.jsx(q.Main,{"aria-busy":C,children:e.jsxs("form",{onSubmit:E,children:[e.jsx(g.Header,{navigationAction:e.jsx(F,{tag:K,startIcon:e.jsx(Q,{}),to:`/plugins/${u}`,id:"go-back",children:s({id:o("config.back"),defaultMessage:"Back"})}),primaryAction:e.jsx(P,{size:"S",startIcon:e.jsx(G,{}),disabled:B(l,w),type:"submit",fullWidth:!0,children:s({id:"global.save",defaultMessage:"Save"})}),subtitle:s({id:o("config.subtitle"),defaultMessage:"Define the view settings of the media library."}),title:s({id:o("config.title"),defaultMessage:"Configure the view - Media Library"})}),e.jsx(g.Content,{children:e.jsx(Y,{"data-testid":"settings",pageSize:l.pageSize||"",sort:l.sort||"",onChange:R})}),e.jsx(V.Root,{open:S,onOpenChange:f,children:e.jsx(X,{onConfirm:N,variant:"default",children:s({id:o("config.popUpWarning.warning.updateAllSettings"),defaultMessage:"This will modify all your settings"})})})]})})})};export{se as ConfigureTheView};
