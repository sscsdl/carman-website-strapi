import{c0 as S,a as x,j as t,a6 as N,T as y,b as A,Q as B,S as F,W as P,X as _,Y as p,Z as j,$ as z,I as m,a0 as H,o as O,a2 as U,_ as q,r as G,c1 as Q,l as b}from"./strapi-D0ivxu6x.js";import{W as u}from"./WidgetHelpers-D_vu1lKI.js";const X=S.enhanceEndpoints({addTagTypes:["RecentDocumentList"]}).injectEndpoints({overrideExisting:!0,endpoints:e=>({getRecentDocuments:e.query({query:a=>`/content-manager/homepage/recent-documents?action=${a.action}`,transformResponse:a=>a.data,providesTags:(a,i,{action:o})=>[{type:"RecentDocumentList",id:o}]})})}),{useGetRecentDocumentsQuery:T}=X,D="14.4rem",E=(e=4)=>{const o=14.4*e/4;return`${Math.round(o*10)/10}rem`},k=b(m)`
  display: block;
  max-width: ${({$maxWidth:e})=>e||D};
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
`,R=({documents:e,type:a,dynamicMaxWidth:i=D})=>{const{formatMessage:o}=x(),{trackUsage:r}=A(),c=B(),g=s=>{const h=s.kind==="singleType",n=h?"single-types":"collection-types",d=s.locale?`?plugins[i18n][locale]=${s.locale}`:"";return`/content-manager/${n}/${s.contentTypeUid}${h?"":"/"+s.documentId}${d}`},f=s=>()=>{r("willEditEntryFromHome",{entryType:a});const h=g(s);c(h)};return t.jsx(F,{colCount:5,rowCount:e?.length??0,children:t.jsx(P,{children:e?.map(s=>t.jsxs(_,{onClick:f(s),cursor:"pointer",children:[t.jsx(p,{children:t.jsx(k,{title:s.title,variant:"omega",textColor:"neutral800",$maxWidth:i,children:s.title})}),t.jsx(p,{children:t.jsx(k,{variant:"omega",textColor:"neutral600",$maxWidth:i,children:s.kind==="singleType"?o({id:"content-manager.widget.last-edited.single-type",defaultMessage:"Single-Type"}):o({id:s.contentTypeDisplayName,defaultMessage:s.contentTypeDisplayName})})}),t.jsx(p,{children:t.jsx(j,{display:"inline-block",children:s.status?t.jsx(z,{status:s.status}):t.jsx(m,{textColor:"neutral600","aria-hidden":!0,children:"-"})})}),t.jsx(p,{children:t.jsx(m,{textColor:"neutral600",children:t.jsx(H,{timestamp:new Date(s.updatedAt)})})}),t.jsx(p,{onClick:h=>h.stopPropagation(),children:t.jsx(j,{display:"inline-block",children:t.jsx(O,{tag:U,to:g(s),onClick:()=>r("willEditEntryFromHome",{type:a}),label:o({id:"content-manager.actions.edit.label",defaultMessage:"Edit"}),variant:"ghost",children:t.jsx(q,{})})})})]},s.documentId))})})},tt=({columnWidth:e=6})=>{const{formatMessage:a}=x(),{data:i,isLoading:o,error:r}=T({action:"update"}),c=E(e);return o?t.jsx(u.Loading,{}):r||!i?t.jsx(u.Error,{}):i.length===0?t.jsx(u.NoData,{children:a({id:"content-manager.widget.last-edited.no-data",defaultMessage:"No edited entries"})}):t.jsx(R,{documents:i,type:"edited",dynamicMaxWidth:c})},et=({columnWidth:e=6})=>{const{formatMessage:a}=x(),{data:i,isLoading:o,error:r}=T({action:"publish"}),c=E(e);return o?t.jsx(u.Loading,{}):r||!i?t.jsx(u.Error,{}):i.length===0?t.jsx(u.NoData,{children:a({id:"content-manager.widget.last-published.no-data",defaultMessage:"No published entries"})}):t.jsx(R,{documents:i,type:"published",dynamicMaxWidth:c})},l=80,w=10,C=2*Math.PI*(l-w/2),K=b.circle`
  stroke: ${({theme:e,$arcColor:a})=>e.colors[a]};
`,v=b.tspan`
  text-transform: lowercase;
  fill: ${({theme:e,$textColor:a})=>e.colors[a]};
`,V=b(y)`
  width: 100%;

  ${({theme:e})=>e.breakpoints.small} {
    width: auto;
  }
`,Y=({data:e})=>{const{locale:a}=x(),{formatMessage:i}=x(),o=e.reduce((n,d)=>n+d.count,0),[r,c]=G.useState({visible:!1,x:0,y:0,value:null});let g=0;const f=(n,d)=>{c({visible:!0,x:n.clientX,y:n.clientY,value:d})},s=()=>{c(n=>({...n,visible:!1}))},h=(n,d)=>{c({visible:!0,x:n.currentTarget.getBoundingClientRect().width/2+n.currentTarget.getBoundingClientRect().left,y:n.currentTarget.getBoundingClientRect().height+n.currentTarget.getBoundingClientRect().top,value:d})};return t.jsxs(y,{direction:"column",gap:6,margin:"auto",children:[t.jsxs("svg",{width:l*2,height:l*2,viewBox:`0 0 ${l*2} ${l*2}`,style:{position:"relative",zIndex:1},children:[t.jsx("g",{transform:`rotate(-90 ${l} ${l})`,children:e.map(n=>{const d=n.count/o*100,$=d/100*C,W=`${$} ${C-$}`,L=C*(1-g/100),I=t.jsx(K,{cx:l,cy:l,r:l-w/2,fill:"none",strokeWidth:w,strokeDasharray:W,strokeDashoffset:L,style:{transition:"stroke-dashoffset 0.3s",cursor:"pointer"},tabIndex:0,"aria-describedby":r.visible?"chart-tooltip":void 0,onFocus:M=>h(M,n),onBlur:s,onMouseMove:M=>f(M,n),onMouseLeave:s,$arcColor:n.color},n.label);return g+=d,I})}),t.jsxs("text",{x:l,y:l,textAnchor:"middle",fontSize:"2.4rem",fontWeight:"bold",children:[t.jsx(v,{x:l,dy:"0",$textColor:"neutral800",children:new Intl.NumberFormat(a,{notation:"compact",maximumFractionDigits:1}).format(o)}),t.jsx(v,{x:l,dy:"1.4em",fontSize:"1.4rem",fontWeight:"normal",$textColor:"neutral600",children:i({id:"content-manager.widget.chart-entries.count.label",defaultMessage:"{count, plural, =0 {entries} one {entry} other {entries}}"},{count:o})})]})]}),r.visible&&r.value&&t.jsx(Q,{style:{position:"fixed",left:16,top:16,zIndex:2,transform:`translate(${r.x}px, ${r.y}px)`},"data-testid":"entries-chart-tooltip",children:t.jsx(j,{background:"neutral900",padding:2,borderRadius:1,textAlign:"center",role:"tooltip","aria-live":"polite",children:t.jsx(m,{textColor:"neutral0",children:i({id:"content-manager.widget.chart-entries.tooltip",defaultMessage:"{count} items"},{count:r.value.count,label:r.value.label})})})}),t.jsx(y,{gap:4,wrap:"wrap",children:e.map(n=>n.count>0&&t.jsxs(V,{gap:1,children:[t.jsx(j,{background:n.color,padding:2,borderRadius:1}),t.jsx(m,{variant:"pi",children:n.label})]},n.label))})]})},nt=()=>{const{formatMessage:e}=x(),{data:a,isLoading:i,error:o}=N();if(i)return t.jsx(u.Loading,{});if(o)return t.jsx(u.Error,{});const{draft:r,published:c,modified:g}=a??{draft:0,published:0,modified:0};return r+c+g?t.jsx(y,{minHeight:"100%",children:t.jsx(Y,{data:[{label:e({id:"content-manager.containers.List.draft",defaultMessage:"Draft"}),count:r,color:"secondary500"},{label:e({id:"content-manager.containers.List.modified",defaultMessage:"Modified"}),count:g,color:"alternative500"},{label:e({id:"content-manager.containers.List.published",defaultMessage:"Published"}),count:c,color:"success500"}]})}):t.jsx(u.NoData,{children:e({id:"content-manager.widget.last-published.no-data",defaultMessage:"No published entries"})})};export{nt as ChartEntriesWidget,tt as LastEditedWidget,et as LastPublishedWidget};
