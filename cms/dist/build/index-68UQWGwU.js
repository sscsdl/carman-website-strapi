import{g_ as br,g$ as _r,h0 as ye,h1 as Le,h2 as $r,h3 as xr,d1 as k,ce as Cr,r as y,j as i,aP as T,l as te,Z as M,gu as Or,a as E,T as x,I as b,bG as De,U as S,bH as ht,cs as Ar,cb as pt,eU as K,cd as j,b2 as Sr,b3 as Ne,b4 as qe,q as re,c9 as Q,p as gt,P as C,cf as w,Q as mt,b as vt,ch as _e,bv as yt,bw as bt,L as I,bx as _t,z as $t,y as xt,H as O,aY as Ct,by as Ot,aJ as Pr,cg as At,W as jr,X as St,Y,aH as Pt,_ as Rr,o as wr,bD as Mr,bW as Er,a$ as Tr,u as Ir,w as Lr,dT as Dr,bk as Nr,aG as qr,aI as Hr,S as Fr,bE as Br,bF as Z,aF as Gr,bK as Ur,bL as kr,R as Kr,J as pe}from"./strapi-D0ivxu6x.js";import{P as _}from"./index-3lrmPvxo.js";import{u as Qr,i as P,a as ne,t as zr,_ as $e,b as jt}from"./upperFirst-DbNbFuGo.js";import{a as Rt,b as se,c as wt,d as Mt,e as Wr,f as xe,g as Ce,h as Et,j as Xr,k as Tt,i as It,l as ae,m as Lt}from"./_getTag-ryJ-JVfa.js";import{S as Yr}from"./SearchInput-BlCSDN9b.js";var Zr=function(e){br(t,e);function t(n,a){var s;return s=e.call(this)||this,s.client=n,s.queries=[],s.result=[],s.observers=[],s.observersMap={},a&&s.setQueries(a),s}var r=t.prototype;return r.onSubscribe=function(){var a=this;this.listeners.length===1&&this.observers.forEach(function(s){s.subscribe(function(o){a.onUpdate(s,o)})})},r.onUnsubscribe=function(){this.listeners.length||this.destroy()},r.destroy=function(){this.listeners=[],this.observers.forEach(function(a){a.destroy()})},r.setQueries=function(a,s){this.queries=a,this.updateObservers(s)},r.getCurrentResult=function(){return this.result},r.getOptimisticResult=function(a){return this.findMatchingObservers(a).map(function(s){return s.observer.getOptimisticResult(s.defaultedQueryOptions)})},r.findMatchingObservers=function(a){var s=this,o=this.observers,c=a.map(function(p){return s.client.defaultQueryObserverOptions(p)}),l=c.flatMap(function(p){var m=o.find(function(v){return v.options.queryHash===p.queryHash});return m!=null?[{defaultedQueryOptions:p,observer:m}]:[]}),u=l.map(function(p){return p.defaultedQueryOptions.queryHash}),h=c.filter(function(p){return!u.includes(p.queryHash)}),f=o.filter(function(p){return!l.some(function(m){return m.observer===p})}),d=h.map(function(p,m){if(p.keepPreviousData){var v=f[m];if(v!==void 0)return{defaultedQueryOptions:p,observer:v}}return{defaultedQueryOptions:p,observer:s.getObserver(p)}}),g=function(m,v){return c.indexOf(m.defaultedQueryOptions)-c.indexOf(v.defaultedQueryOptions)};return l.concat(d).sort(g)},r.getObserver=function(a){var s=this.client.defaultQueryObserverOptions(a),o=this.observersMap[s.queryHash];return o??new _r(this.client,s)},r.updateObservers=function(a){var s=this;ye.batch(function(){var o=s.observers,c=s.findMatchingObservers(s.queries);c.forEach(function(d){return d.observer.setOptions(d.defaultedQueryOptions,a)});var l=c.map(function(d){return d.observer}),u=Object.fromEntries(l.map(function(d){return[d.options.queryHash,d]})),h=l.map(function(d){return d.getCurrentResult()}),f=l.some(function(d,g){return d!==o[g]});o.length===l.length&&!f||(s.observers=l,s.observersMap=u,s.result=h,s.hasListeners()&&(Le(o,l).forEach(function(d){d.destroy()}),Le(l,o).forEach(function(d){d.subscribe(function(g){s.onUpdate(d,g)})}),s.notify()))})},r.onUpdate=function(a,s){var o=this.observers.indexOf(a);o!==-1&&(this.result=$r(this.result,o,s),this.notify())},r.notify=function(){var a=this;ye.batch(function(){a.listeners.forEach(function(s){s(a.result)})})},t}(xr);function Jr(e){var t=k.useRef(!1),r=k.useState(0),n=r[1],a=Cr(),s=y.useMemo(function(){return e.map(function(u){var h=a.defaultQueryObserverOptions(u);return h.optimisticResults=!0,h})},[e,a]),o=k.useState(function(){return new Zr(a,s)}),c=o[0],l=c.getOptimisticResult(s);return k.useEffect(function(){t.current=!0;var u=c.subscribe(ye.batchCalls(function(){t.current&&n(function(h){return h+1})}));return function(){t.current=!1,u()}},[c]),k.useEffect(function(){c.setQueries(s,{listeners:!1})},[s,c]),l}const Dt=y.createContext({}),Nt=({children:e,value:t})=>i.jsx(Dt.Provider,{value:t,children:e}),Oe=()=>y.useContext(Dt);Nt.propTypes={children:_.node.isRequired,value:_.object.isRequired};function Vr(e){switch(e){case"application":return"Application";case"plugin::content-manager":return"Content manager";case"plugin::content-type-builder":return"Content types builder";case"plugin::documentation":return"Documentation";case"plugin::email":return"Email";case"plugin::i18n":return"i18n";case"plugin::upload":return"Media Library";case"plugin::users-permissions":return"Users-permissions";default:return Qr(e.replace("api::","").replace("plugin::",""))}}const en=(e,t)=>{const r=Object.keys(t).sort().map(n=>({name:n,isOpen:!1}));return{...e,collapses:r}};function tn(e,t){for(var r=-1,n=t.length,a=e.length;++r<n;)e[a+r]=t[r];return e}var qt=tn,He=Rt,rn=se,nn=P,Fe=He?He.isConcatSpreadable:void 0;function sn(e){return nn(e)||rn(e)||!!(Fe&&e&&e[Fe])}var an=sn,on=qt,cn=an;function Ht(e,t,r,n,a){var s=-1,o=e.length;for(r||(r=cn),a||(a=[]);++s<o;){var c=e[s];t>0&&r(c)?t>1?Ht(c,t-1,r,n,a):on(a,c):n||(a[a.length]=c)}return a}var ln=Ht,un=P,dn=ne,fn=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,hn=/^\w*$/;function pn(e,t){if(un(e))return!1;var r=typeof e;return r=="number"||r=="symbol"||r=="boolean"||e==null||dn(e)?!0:hn.test(e)||!fn.test(e)||t!=null&&e in Object(t)}var Ae=pn,gn=wt,mn=gn(Object,"create"),ie=mn,Be=ie;function vn(){this.__data__=Be?Be(null):{},this.size=0}var yn=vn;function bn(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var _n=bn,$n=ie,xn="__lodash_hash_undefined__",Cn=Object.prototype,On=Cn.hasOwnProperty;function An(e){var t=this.__data__;if($n){var r=t[e];return r===xn?void 0:r}return On.call(t,e)?t[e]:void 0}var Sn=An,Pn=ie,jn=Object.prototype,Rn=jn.hasOwnProperty;function wn(e){var t=this.__data__;return Pn?t[e]!==void 0:Rn.call(t,e)}var Mn=wn,En=ie,Tn="__lodash_hash_undefined__";function In(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=En&&t===void 0?Tn:t,this}var Ln=In,Dn=yn,Nn=_n,qn=Sn,Hn=Mn,Fn=Ln;function q(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}q.prototype.clear=Dn;q.prototype.delete=Nn;q.prototype.get=qn;q.prototype.has=Hn;q.prototype.set=Fn;var Bn=q;function Gn(){this.__data__=[],this.size=0}var Un=Gn;function kn(e,t){return e===t||e!==e&&t!==t}var oe=kn,Kn=oe;function Qn(e,t){for(var r=e.length;r--;)if(Kn(e[r][0],t))return r;return-1}var ce=Qn,zn=ce,Wn=Array.prototype,Xn=Wn.splice;function Yn(e){var t=this.__data__,r=zn(t,e);if(r<0)return!1;var n=t.length-1;return r==n?t.pop():Xn.call(t,r,1),--this.size,!0}var Zn=Yn,Jn=ce;function Vn(e){var t=this.__data__,r=Jn(t,e);return r<0?void 0:t[r][1]}var es=Vn,ts=ce;function rs(e){return ts(this.__data__,e)>-1}var ns=rs,ss=ce;function as(e,t){var r=this.__data__,n=ss(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this}var is=as,os=Un,cs=Zn,ls=es,us=ns,ds=is;function H(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}H.prototype.clear=os;H.prototype.delete=cs;H.prototype.get=ls;H.prototype.has=us;H.prototype.set=ds;var le=H,Ge=Bn,fs=le,hs=Mt;function ps(){this.size=0,this.__data__={hash:new Ge,map:new(hs||fs),string:new Ge}}var gs=ps;function ms(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}var vs=ms,ys=vs;function bs(e,t){var r=e.__data__;return ys(t)?r[typeof t=="string"?"string":"hash"]:r.map}var ue=bs,_s=ue;function $s(e){var t=_s(this,e).delete(e);return this.size-=t?1:0,t}var xs=$s,Cs=ue;function Os(e){return Cs(this,e).get(e)}var As=Os,Ss=ue;function Ps(e){return Ss(this,e).has(e)}var js=Ps,Rs=ue;function ws(e,t){var r=Rs(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this}var Ms=ws,Es=gs,Ts=xs,Is=As,Ls=js,Ds=Ms;function F(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}F.prototype.clear=Es;F.prototype.delete=Ts;F.prototype.get=Is;F.prototype.has=Ls;F.prototype.set=Ds;var Se=F,Ft=Se,Ns="Expected a function";function Pe(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(Ns);var r=function(){var n=arguments,a=t?t.apply(this,n):n[0],s=r.cache;if(s.has(a))return s.get(a);var o=e.apply(this,n);return r.cache=s.set(a,o)||s,o};return r.cache=new(Pe.Cache||Ft),r}Pe.Cache=Ft;var qs=Pe,Hs=qs,Fs=500;function Bs(e){var t=Hs(e,function(n){return r.size===Fs&&r.clear(),n}),r=t.cache;return t}var Gs=Bs,Us=Gs,ks=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Ks=/\\(\\)?/g,Qs=Us(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(ks,function(r,n,a,s){t.push(a?s.replace(Ks,"$1"):n||r)}),t}),zs=Qs,Ws=P,Xs=Ae,Ys=zs,Zs=zr;function Js(e,t){return Ws(e)?e:Xs(e,t)?[e]:Ys(Zs(e))}var je=Js,Vs=ne;function ea(e){if(typeof e=="string"||Vs(e))return e;var t=e+"";return t=="0"&&1/e==-1/0?"-0":t}var z=ea,ta=je,ra=z;function na(e,t){t=ta(t,e);for(var r=0,n=t.length;e!=null&&r<n;)e=e[ra(t[r++])];return r&&r==n?e:void 0}var Re=na,sa=le;function aa(){this.__data__=new sa,this.size=0}var ia=aa;function oa(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}var ca=oa;function la(e){return this.__data__.get(e)}var ua=la;function da(e){return this.__data__.has(e)}var fa=da,ha=le,pa=Mt,ga=Se,ma=200;function va(e,t){var r=this.__data__;if(r instanceof ha){var n=r.__data__;if(!pa||n.length<ma-1)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new ga(n)}return r.set(e,t),this.size=r.size,this}var ya=va,ba=le,_a=ia,$a=ca,xa=ua,Ca=fa,Oa=ya;function B(e){var t=this.__data__=new ba(e);this.size=t.size}B.prototype.clear=_a;B.prototype.delete=$a;B.prototype.get=xa;B.prototype.has=Ca;B.prototype.set=Oa;var Bt=B,Aa="__lodash_hash_undefined__";function Sa(e){return this.__data__.set(e,Aa),this}var Pa=Sa;function ja(e){return this.__data__.has(e)}var Ra=ja,wa=Se,Ma=Pa,Ea=Ra;function V(e){var t=-1,r=e==null?0:e.length;for(this.__data__=new wa;++t<r;)this.add(e[t])}V.prototype.add=V.prototype.push=Ma;V.prototype.has=Ea;var Gt=V;function Ta(e,t){for(var r=-1,n=e==null?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}var Ia=Ta;function La(e,t){return e.has(t)}var Ut=La,Da=Gt,Na=Ia,qa=Ut,Ha=1,Fa=2;function Ba(e,t,r,n,a,s){var o=r&Ha,c=e.length,l=t.length;if(c!=l&&!(o&&l>c))return!1;var u=s.get(e),h=s.get(t);if(u&&h)return u==t&&h==e;var f=-1,d=!0,g=r&Fa?new Da:void 0;for(s.set(e,t),s.set(t,e);++f<c;){var p=e[f],m=t[f];if(n)var v=o?n(m,p,f,t,e,s):n(p,m,f,e,t,s);if(v!==void 0){if(v)continue;d=!1;break}if(g){if(!Na(t,function($,R){if(!qa(g,R)&&(p===$||a(p,$,r,n,s)))return g.push(R)})){d=!1;break}}else if(!(p===m||a(p,m,r,n,s))){d=!1;break}}return s.delete(e),s.delete(t),d}var kt=Ba,Ga=Wr,Ua=Ga.Uint8Array,ka=Ua;function Ka(e){var t=-1,r=Array(e.size);return e.forEach(function(n,a){r[++t]=[a,n]}),r}var Qa=Ka;function za(e){var t=-1,r=Array(e.size);return e.forEach(function(n){r[++t]=n}),r}var Wa=za,Ue=Rt,ke=ka,Xa=oe,Ya=kt,Za=Qa,Ja=Wa,Va=1,ei=2,ti="[object Boolean]",ri="[object Date]",ni="[object Error]",si="[object Map]",ai="[object Number]",ii="[object RegExp]",oi="[object Set]",ci="[object String]",li="[object Symbol]",ui="[object ArrayBuffer]",di="[object DataView]",Ke=Ue?Ue.prototype:void 0,ge=Ke?Ke.valueOf:void 0;function fi(e,t,r,n,a,s,o){switch(r){case di:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case ui:return!(e.byteLength!=t.byteLength||!s(new ke(e),new ke(t)));case ti:case ri:case ai:return Xa(+e,+t);case ni:return e.name==t.name&&e.message==t.message;case ii:case ci:return e==t+"";case si:var c=Za;case oi:var l=n&Va;if(c||(c=Ja),e.size!=t.size&&!l)return!1;var u=o.get(e);if(u)return u==t;n|=ei,o.set(e,t);var h=Ya(c(e),c(t),n,a,s,o);return o.delete(e),h;case li:if(ge)return ge.call(e)==ge.call(t)}return!1}var hi=fi,pi=qt,gi=P;function mi(e,t,r){var n=t(e);return gi(e)?n:pi(n,r(e))}var vi=mi;function yi(e,t){for(var r=-1,n=e==null?0:e.length,a=0,s=[];++r<n;){var o=e[r];t(o,r,e)&&(s[a++]=o)}return s}var bi=yi;function _i(){return[]}var $i=_i,xi=bi,Ci=$i,Oi=Object.prototype,Ai=Oi.propertyIsEnumerable,Qe=Object.getOwnPropertySymbols,Si=Qe?function(e){return e==null?[]:(e=Object(e),xi(Qe(e),function(t){return Ai.call(e,t)}))}:Ci,Pi=Si;function ji(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}var Ri=ji,wi=9007199254740991,Mi=/^(?:0|[1-9]\d*)$/;function Ei(e,t){var r=typeof e;return t=t??wi,!!t&&(r=="number"||r!="symbol"&&Mi.test(e))&&e>-1&&e%1==0&&e<t}var de=Ei,Ti=Ri,Ii=se,Li=P,Di=xe,Ni=de,qi=Ce,Hi=Object.prototype,Fi=Hi.hasOwnProperty;function Bi(e,t){var r=Li(e),n=!r&&Ii(e),a=!r&&!n&&Di(e),s=!r&&!n&&!a&&qi(e),o=r||n||a||s,c=o?Ti(e.length,String):[],l=c.length;for(var u in e)(t||Fi.call(e,u))&&!(o&&(u=="length"||a&&(u=="offset"||u=="parent")||s&&(u=="buffer"||u=="byteLength"||u=="byteOffset")||Ni(u,l)))&&c.push(u);return c}var Gi=Bi,Ui=Object.prototype;function ki(e){var t=e&&e.constructor,r=typeof t=="function"&&t.prototype||Ui;return e===r}var Kt=ki;function Ki(e,t){return function(r){return e(t(r))}}var Qi=Ki,zi=Qi,Wi=zi(Object.keys,Object),Xi=Wi,Yi=Kt,Zi=Xi,Ji=Object.prototype,Vi=Ji.hasOwnProperty;function eo(e){if(!Yi(e))return Zi(e);var t=[];for(var r in Object(e))Vi.call(e,r)&&r!="constructor"&&t.push(r);return t}var Qt=eo,to=Xr,ro=Et;function no(e){return e!=null&&ro(e.length)&&!to(e)}var G=no,so=Gi,ao=Qt,io=G;function oo(e){return io(e)?so(e):ao(e)}var we=oo,co=vi,lo=Pi,uo=we;function fo(e){return co(e,uo,lo)}var ho=fo,ze=ho,po=1,go=Object.prototype,mo=go.hasOwnProperty;function vo(e,t,r,n,a,s){var o=r&po,c=ze(e),l=c.length,u=ze(t),h=u.length;if(l!=h&&!o)return!1;for(var f=l;f--;){var d=c[f];if(!(o?d in t:mo.call(t,d)))return!1}var g=s.get(e),p=s.get(t);if(g&&p)return g==t&&p==e;var m=!0;s.set(e,t),s.set(t,e);for(var v=o;++f<l;){d=c[f];var $=e[d],R=t[d];if(n)var U=o?n(R,$,d,t,e,s):n($,R,d,e,t,s);if(!(U===void 0?$===R||a($,R,r,n,s):U)){m=!1;break}v||(v=d=="constructor")}if(m&&!v){var L=e.constructor,D=t.constructor;L!=D&&"constructor"in e&&"constructor"in t&&!(typeof L=="function"&&L instanceof L&&typeof D=="function"&&D instanceof D)&&(m=!1)}return s.delete(e),s.delete(t),m}var yo=vo,me=Bt,bo=kt,_o=hi,$o=yo,We=Tt,Xe=P,Ye=xe,xo=Ce,Co=1,Ze="[object Arguments]",Je="[object Array]",J="[object Object]",Oo=Object.prototype,Ve=Oo.hasOwnProperty;function Ao(e,t,r,n,a,s){var o=Xe(e),c=Xe(t),l=o?Je:We(e),u=c?Je:We(t);l=l==Ze?J:l,u=u==Ze?J:u;var h=l==J,f=u==J,d=l==u;if(d&&Ye(e)){if(!Ye(t))return!1;o=!0,h=!1}if(d&&!h)return s||(s=new me),o||xo(e)?bo(e,t,r,n,a,s):_o(e,t,l,r,n,a,s);if(!(r&Co)){var g=h&&Ve.call(e,"__wrapped__"),p=f&&Ve.call(t,"__wrapped__");if(g||p){var m=g?e.value():e,v=p?t.value():t;return s||(s=new me),a(m,v,r,n,s)}}return d?(s||(s=new me),$o(e,t,r,n,a,s)):!1}var So=Ao,Po=So,et=It;function zt(e,t,r,n,a){return e===t?!0:e==null||t==null||!et(e)&&!et(t)?e!==e&&t!==t:Po(e,t,r,n,zt,a)}var Wt=zt,jo=Bt,Ro=Wt,wo=1,Mo=2;function Eo(e,t,r,n){var a=r.length,s=a,o=!n;if(e==null)return!s;for(e=Object(e);a--;){var c=r[a];if(o&&c[2]?c[1]!==e[c[0]]:!(c[0]in e))return!1}for(;++a<s;){c=r[a];var l=c[0],u=e[l],h=c[1];if(o&&c[2]){if(u===void 0&&!(l in e))return!1}else{var f=new jo;if(n)var d=n(u,h,l,e,t,f);if(!(d===void 0?Ro(h,u,wo|Mo,n,f):d))return!1}}return!0}var To=Eo,Io=ae;function Lo(e){return e===e&&!Io(e)}var Xt=Lo,Do=Xt,No=we;function qo(e){for(var t=No(e),r=t.length;r--;){var n=t[r],a=e[n];t[r]=[n,a,Do(a)]}return t}var Ho=qo;function Fo(e,t){return function(r){return r==null?!1:r[e]===t&&(t!==void 0||e in Object(r))}}var Yt=Fo,Bo=To,Go=Ho,Uo=Yt;function ko(e){var t=Go(e);return t.length==1&&t[0][2]?Uo(t[0][0],t[0][1]):function(r){return r===e||Bo(r,e,t)}}var Ko=ko,Qo=Re;function zo(e,t,r){var n=e==null?void 0:Qo(e,t);return n===void 0?r:n}var Zt=zo;const ee=T(Zt);function Wo(e,t){return e!=null&&t in Object(e)}var Xo=Wo,Yo=je,Zo=se,Jo=P,Vo=de,ec=Et,tc=z;function rc(e,t,r){t=Yo(t,e);for(var n=-1,a=t.length,s=!1;++n<a;){var o=tc(t[n]);if(!(s=e!=null&&r(e,o)))break;e=e[o]}return s||++n!=a?s:(a=e==null?0:e.length,!!a&&ec(a)&&Vo(o,a)&&(Jo(e)||Zo(e)))}var nc=rc,sc=Xo,ac=nc;function ic(e,t){return e!=null&&ac(e,t,sc)}var oc=ic,cc=Wt,lc=Zt,uc=oc,dc=Ae,fc=Xt,hc=Yt,pc=z,gc=1,mc=2;function vc(e,t){return dc(e)&&fc(t)?hc(pc(e),t):function(r){var n=lc(r,e);return n===void 0&&n===t?uc(r,e):cc(t,n,gc|mc)}}var yc=vc;function bc(e){return e}var fe=bc;function _c(e){return function(t){return t?.[e]}}var $c=_c,xc=Re;function Cc(e){return function(t){return xc(t,e)}}var Oc=Cc,Ac=$c,Sc=Oc,Pc=Ae,jc=z;function Rc(e){return Pc(e)?Ac(jc(e)):Sc(e)}var wc=Rc,Mc=Ko,Ec=yc,Tc=fe,Ic=P,Lc=wc;function Dc(e){return typeof e=="function"?e:e==null?Tc:typeof e=="object"?Ic(e)?Ec(e[0],e[1]):Mc(e):Lc(e)}var Jt=Dc;function Nc(e){return function(t,r,n){for(var a=-1,s=Object(t),o=n(t),c=o.length;c--;){var l=o[e?c:++a];if(r(s[l],l,s)===!1)break}return t}}var qc=Nc,Hc=qc,Fc=Hc(),Bc=Fc,Gc=Bc,Uc=we;function kc(e,t){return e&&Gc(e,t,Uc)}var Kc=kc,Qc=G;function zc(e,t){return function(r,n){if(r==null)return r;if(!Qc(r))return e(r,n);for(var a=r.length,s=t?a:-1,o=Object(r);(t?s--:++s<a)&&n(o[s],s,o)!==!1;);return r}}var Wc=zc,Xc=Kc,Yc=Wc,Zc=Yc(Xc),Jc=Zc,Vc=Jc,el=G;function tl(e,t){var r=-1,n=el(e)?Array(e.length):[];return Vc(e,function(a,s,o){n[++r]=t(a,s,o)}),n}var Vt=tl;function rl(e,t){var r=e.length;for(e.sort(t);r--;)e[r]=e[r].value;return e}var nl=rl,tt=ne;function sl(e,t){if(e!==t){var r=e!==void 0,n=e===null,a=e===e,s=tt(e),o=t!==void 0,c=t===null,l=t===t,u=tt(t);if(!c&&!u&&!s&&e>t||s&&o&&l&&!c&&!u||n&&o&&l||!r&&l||!a)return 1;if(!n&&!s&&!u&&e<t||u&&r&&a&&!n&&!s||c&&r&&a||!o&&a||!l)return-1}return 0}var al=sl,il=al;function ol(e,t,r){for(var n=-1,a=e.criteria,s=t.criteria,o=a.length,c=r.length;++n<o;){var l=il(a[n],s[n]);if(l){if(n>=c)return l;var u=r[n];return l*(u=="desc"?-1:1)}}return e.index-t.index}var cl=ol,ve=$e,ll=Re,ul=Jt,dl=Vt,fl=nl,hl=Lt,pl=cl,gl=fe,ml=P;function vl(e,t,r){t.length?t=ve(t,function(s){return ml(s)?function(o){return ll(o,s.length===1?s[0]:s)}:s}):t=[gl];var n=-1;t=ve(t,hl(ul));var a=dl(e,function(s,o,c){var l=ve(t,function(u){return u(s)});return{criteria:l,index:++n,value:s}});return fl(a,function(s,o){return pl(s,o,r)})}var yl=vl;function bl(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}var _l=bl,$l=_l,rt=Math.max;function xl(e,t,r){return t=rt(t===void 0?e.length-1:t,0),function(){for(var n=arguments,a=-1,s=rt(n.length-t,0),o=Array(s);++a<s;)o[a]=n[t+a];a=-1;for(var c=Array(t+1);++a<t;)c[a]=n[a];return c[t]=r(o),$l(e,this,c)}}var Cl=xl;function Ol(e){return function(){return e}}var Al=Ol,Sl=wt,Pl=function(){try{var e=Sl(Object,"defineProperty");return e({},"",{}),e}catch{}}(),er=Pl,jl=Al,nt=er,Rl=fe,wl=nt?function(e,t){return nt(e,"toString",{configurable:!0,enumerable:!1,value:jl(t),writable:!0})}:Rl,Ml=wl,El=800,Tl=16,Il=Date.now;function Ll(e){var t=0,r=0;return function(){var n=Il(),a=Tl-(n-r);if(r=n,a>0){if(++t>=El)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}var Dl=Ll,Nl=Ml,ql=Dl,Hl=ql(Nl),Fl=Hl,Bl=fe,Gl=Cl,Ul=Fl;function kl(e,t){return Ul(Gl(e,t,Bl),e+"")}var tr=kl,Kl=oe,Ql=G,zl=de,Wl=ae;function Xl(e,t,r){if(!Wl(r))return!1;var n=typeof t;return(n=="number"?Ql(r)&&zl(t,r.length):n=="string"&&t in r)?Kl(r[t],e):!1}var Yl=Xl,Zl=ln,Jl=yl,Vl=tr,st=Yl,eu=Vl(function(e,t){if(e==null)return[];var r=t.length;return r>1&&st(e,t[0],t[1])?t=[]:r>2&&st(t[0],t[1],t[2])&&(t=[t[0]]),Jl(e,Zl(t,1),[])}),tu=eu;const at=T(tu),it=Or`
  background: ${e=>e.theme.colors.primary100};

  #cog {
    opacity: 1;
  }
`,ru=te(M)`
  display: flex;
  justify-content: space-between;
  align-items: center;

  #cog {
    opacity: 0;
    path {
      fill: ${e=>e.theme.colors.primary600};
    }
  }

  /* Show active style both on hover and when the action is selected */
  ${e=>e.isActive&&it}
  &:hover {
    ${it}
  }
`,nu=te.div`
  flex: 1;
  align-self: center;
  border-top: 1px solid ${({theme:e})=>e.colors.neutral150};
`,rr=({subCategory:e})=>{const{formatMessage:t}=E(),{onChange:r,onChangeSelectAll:n,onSelectedAction:a,selectedAction:s,modifiedData:o}=Oe(),c=y.useMemo(()=>ee(o,e.name,{}),[o,e]),l=y.useMemo(()=>Object.values(c).every(d=>d.enabled===!0),[c]),u=y.useMemo(()=>Object.values(c).some(d=>d.enabled===!0)&&!l,[c,l]),h=y.useCallback(({target:{name:d}})=>{n({target:{name:d,value:!l}})},[l,n]),f=y.useCallback(d=>s===d,[s]);return i.jsxs(M,{children:[i.jsxs(x,{justifyContent:"space-between",alignItems:"center",children:[i.jsx(M,{paddingRight:4,children:i.jsx(b,{variant:"sigma",textColor:"neutral600",children:e.label})}),i.jsx(nu,{}),i.jsx(M,{paddingLeft:4,children:i.jsx(De,{name:e.name,checked:u?"indeterminate":l,onCheckedChange:d=>h({target:{name:e.name,value:d}}),children:t({id:"app.utils.select-all",defaultMessage:"Select all"})})})]}),i.jsx(x,{paddingTop:6,paddingBottom:6,children:i.jsx(S.Root,{gap:2,style:{flex:1},children:e.actions.map(d=>{const g=`${d.name}.enabled`;return i.jsx(S.Item,{col:4,xs:12,s:6,direction:"column",alignItems:"stretch",children:i.jsxs(ru,{isActive:f(d.name),padding:2,hasRadius:!0,children:[i.jsx(De,{checked:ee(o,g,!1),name:g,onCheckedChange:p=>r({target:{name:g,value:p}}),children:d.label}),i.jsxs("button",{type:"button",onClick:()=>a(d.name),style:{display:"inline-flex",alignItems:"center"},children:[i.jsx(ht,{tag:"span",children:t({id:"app.utils.show-bound-route",defaultMessage:"Show bound route for {route}"},{route:d.name})}),i.jsx(Ar,{id:"cog",cursor:"pointer"})]})]})},d.name)})})})]})};rr.propTypes={subCategory:_.object.isRequired};const nr=({name:e,permissions:t})=>{const r=y.useMemo(()=>at(Object.values(t.controllers).reduce((n,a,s)=>{const o=`${e}.controllers.${Object.keys(t.controllers)[s]}`,c=at(Object.keys(a).reduce((l,u)=>[...l,{...a[u],label:u,name:`${o}.${u}`}],[]),"label");return[...n,{actions:c,label:Object.keys(t.controllers)[s],name:o}]},[]),"label"),[e,t]);return i.jsx(M,{padding:6,children:r.map(n=>i.jsx(rr,{subCategory:n},n.name))})};nr.propTypes={name:_.string.isRequired,permissions:_.object.isRequired};const su={collapses:[]},au=(e,t)=>pt(e,r=>{switch(t.type){case"TOGGLE_COLLAPSE":{r.collapses=e.collapses.map((n,a)=>a===t.index?{...n,isOpen:!n.isOpen}:{...n,isOpen:!1});break}default:return r}}),iu=()=>{const{modifiedData:e}=Oe(),{formatMessage:t}=E(),[{collapses:r}]=y.useReducer(au,su,n=>en(n,e));return i.jsx(K.Root,{size:"M",children:i.jsx(x,{direction:"column",alignItems:"stretch",gap:1,children:r.map((n,a)=>i.jsxs(K.Item,{value:n.name,children:[i.jsx(K.Header,{variant:a%2===0?"secondary":void 0,children:i.jsx(K.Trigger,{caretPosition:"right",description:t({id:"users-permissions.Plugin.permissions.plugins.description",defaultMessage:"Define all allowed actions for the {name} plugin."},{name:n.name}),children:Vr(n.name)})}),i.jsx(K.Content,{children:i.jsx(nr,{permissions:e[n.name],name:n.name})})]},n.name))})})};var ou=Qt,cu=Tt,lu=se,uu=P,du=G,fu=xe,hu=Kt,pu=Ce,gu="[object Map]",mu="[object Set]",vu=Object.prototype,yu=vu.hasOwnProperty;function bu(e){if(e==null)return!0;if(du(e)&&(uu(e)||typeof e=="string"||typeof e.splice=="function"||fu(e)||pu(e)||lu(e)))return!e.length;var t=cu(e);if(t==gu||t==mu)return!e.size;if(hu(e))return!ou(e).length;for(var r in e)if(yu.call(e,r))return!1;return!0}var _u=bu;const be=T(_u);function $u(e,t,r,n){for(var a=e.length,s=r+(n?1:-1);n?s--:++s<a;)if(t(e[s],s,e))return s;return-1}var xu=$u;function Cu(e){return e!==e}var Ou=Cu;function Au(e,t,r){for(var n=r-1,a=e.length;++n<a;)if(e[n]===t)return n;return-1}var Su=Au,Pu=xu,ju=Ou,Ru=Su;function wu(e,t,r){return t===t?Ru(e,t,r):Pu(e,ju,r)}var Mu=wu,Eu=Mu;function Tu(e,t){var r=e==null?0:e.length;return!!r&&Eu(e,t,0)>-1}var Iu=Tu;function Lu(e,t,r){for(var n=-1,a=e==null?0:e.length;++n<a;)if(r(t,e[n]))return!0;return!1}var Du=Lu,Nu=Gt,qu=Iu,Hu=Du,Fu=$e,Bu=Lt,Gu=Ut,Uu=200;function ku(e,t,r,n){var a=-1,s=qu,o=!0,c=e.length,l=[],u=t.length;if(!c)return l;r&&(t=Fu(t,Bu(r))),n?(s=Hu,o=!1):t.length>=Uu&&(s=Gu,o=!1,t=new Nu(t));e:for(;++a<c;){var h=e[a],f=r==null?h:r(h);if(h=n||h!==0?h:0,o&&f===f){for(var d=u;d--;)if(t[d]===f)continue e;l.push(h)}else s(t,f,n)||l.push(h)}return l}var Ku=ku,Qu=G,zu=It;function Wu(e){return zu(e)&&Qu(e)}var Xu=Wu,Yu=Ku,Zu=tr,Ju=Xu,Vu=Zu(function(e,t){return Ju(e)?Yu(e,t):[]}),ed=Vu;const td=T(ed);var rd=$e,nd=Jt,sd=Vt,ad=P;function id(e,t){var r=ad(e)?rd:sd;return r(e,nd(t))}var od=id;const cd=T(od);var ld=jt;function ud(e){var t=e==null?0:e.length;return t?ld(e,1,t):[]}var dd=ud;const fd=T(dd),hd=e=>{switch(e){case"POST":return{text:"success600",border:"success200",background:"success100"};case"GET":return{text:"secondary600",border:"secondary200",background:"secondary100"};case"PUT":return{text:"warning600",border:"warning200",background:"warning100"};case"DELETE":return{text:"danger600",border:"danger200",background:"danger100"};default:return{text:"neutral600",border:"neutral200",background:"neutral100"}}},pd=te(M)`
  margin: -1px;
  border-radius: ${({theme:e})=>e.spaces[1]} 0 0 ${({theme:e})=>e.spaces[1]};
`;function Me({route:e}){const{formatMessage:t}=E(),{method:r,handler:n,path:a}=e,s=a?fd(a.split("/")):[],[o="",c=""]=n?n.split("."):[],l=hd(e.method);return i.jsxs(x,{direction:"column",alignItems:"stretch",gap:2,children:[i.jsxs(b,{variant:"delta",tag:"h3",children:[t({id:"users-permissions.BoundRoute.title",defaultMessage:"Bound route to"}),"Â ",i.jsx("span",{children:o}),i.jsxs(b,{variant:"delta",textColor:"primary600",children:[".",c]})]}),i.jsxs(x,{hasRadius:!0,background:"neutral0",borderColor:"neutral200",gap:0,children:[i.jsx(pd,{background:l.background,borderColor:l.border,padding:2,children:i.jsx(b,{fontWeight:"bold",textColor:l.text,children:r})}),i.jsx(M,{paddingLeft:2,paddingRight:2,children:cd(s,u=>i.jsxs(b,{textColor:u.includes(":")?"neutral600":"neutral900",children:["/",u]},u))})]})]})}Me.defaultProps={route:{handler:"Nocontroller.error",method:"GET",path:"/there-is-no-path"}};Me.propTypes={route:_.shape({handler:_.string,method:_.string,path:_.string})};const gd=()=>{const{formatMessage:e}=E(),{selectedAction:t,routes:r}=Oe(),n=td(t.split("."),"controllers"),a=ee(r,n[0]),s=n.slice(1).join("."),o=be(a)?[]:a.filter(c=>c.handler.endsWith(s));return i.jsx(S.Item,{col:5,xs:12,background:"neutral150",paddingTop:6,paddingBottom:6,paddingLeft:7,paddingRight:7,style:{minHeight:"100%"},direction:"column",alignItems:"stretch",children:t?i.jsx(x,{direction:"column",alignItems:"stretch",gap:2,children:o.map((c,l)=>i.jsx(Me,{route:c},l))}):i.jsxs(x,{direction:"column",alignItems:"stretch",gap:2,children:[i.jsx(b,{variant:"delta",tag:"h3",children:e({id:"users-permissions.Policies.header.title",defaultMessage:"Advanced settings"})}),i.jsx(b,{tag:"p",textColor:"neutral600",children:e({id:"users-permissions.Policies.header.hint",defaultMessage:"Select the application's actions or the plugin's actions and click on the cog icon to display the bound route"})})]})})},md=(e,t,r)=>({...e,initialData:t,modifiedData:t,routes:r});var ot=er;function vd(e,t,r){t=="__proto__"&&ot?ot(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}var yd=vd,bd=yd,_d=oe,$d=Object.prototype,xd=$d.hasOwnProperty;function Cd(e,t,r){var n=e[t];(!(xd.call(e,t)&&_d(n,r))||r===void 0&&!(t in e))&&bd(e,t,r)}var Od=Cd,Ad=Od,Sd=je,Pd=de,ct=ae,jd=z;function Rd(e,t,r,n){if(!ct(e))return e;t=Sd(t,e);for(var a=-1,s=t.length,o=s-1,c=e;c!=null&&++a<s;){var l=jd(t[a]),u=r;if(l==="__proto__"||l==="constructor"||l==="prototype")return e;if(a!=o){var h=c[l];u=n?n(h,l,c):void 0,u===void 0&&(u=ct(h)?h:Pd(t[a+1])?[]:{})}Ad(c,l,u),c=c[l]}return e}var wd=Rd,Md=wd;function Ed(e,t,r){return e==null?e:Md(e,t,r)}var Td=Ed;const lt=T(Td);var Id=/\s/;function Ld(e){for(var t=e.length;t--&&Id.test(e.charAt(t)););return t}var Dd=Ld,Nd=Dd,qd=/^\s+/;function Hd(e){return e&&e.slice(0,Nd(e)+1).replace(qd,"")}var Fd=Hd,Bd=Fd,ut=ae,Gd=ne,dt=NaN,Ud=/^[-+]0x[0-9a-f]+$/i,kd=/^0b[01]+$/i,Kd=/^0o[0-7]+$/i,Qd=parseInt;function zd(e){if(typeof e=="number")return e;if(Gd(e))return dt;if(ut(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=ut(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=Bd(e);var r=kd.test(e);return r||Kd.test(e)?Qd(e.slice(2),r?2:8):Ud.test(e)?dt:+e}var Wd=zd,Xd=Wd,ft=1/0,Yd=17976931348623157e292;function Zd(e){if(!e)return e===0?e:0;if(e=Xd(e),e===ft||e===-ft){var t=e<0?-1:1;return t*Yd}return e===e?e:0}var Jd=Zd,Vd=Jd;function ef(e){var t=Vd(e),r=t%1;return t===t?r?t-r:t:0}var tf=ef,rf=jt,nf=tf;function sf(e,t,r){return e&&e.length?(t=r||t===void 0?1:nf(t),rf(e,0,t<0?0:t)):[]}var af=sf;const of=T(af),cf={initialData:{},modifiedData:{},routes:{},selectedAction:"",policies:[]},lf=(e,t)=>pt(e,r=>{switch(t.type){case"ON_CHANGE":{const n=t.keys.length,a=t.keys[n-1]==="enabled";if(t.value&&a){const s=of(t.keys,n-1).join(".");r.selectedAction=s}lt(r,["modifiedData",...t.keys],t.value);break}case"ON_CHANGE_SELECT_ALL":{const n=["modifiedData",...t.keys],a=ee(e,n,{}),s=Object.keys(a).reduce((o,c)=>(o[c]={...a[c],enabled:t.value},o),{});lt(r,n,s);break}case"ON_RESET":{r.modifiedData=e.initialData;break}case"ON_SUBMIT_SUCCEEDED":{r.initialData=e.modifiedData;break}case"SELECT_ACTION":{const{actionToSelect:n}=t;r.selectedAction=n===e.selectedAction?"":n;break}default:return r}}),sr=y.forwardRef(({permissions:e,routes:t},r)=>{const{formatMessage:n}=E(),[a,s]=y.useReducer(lf,cf,h=>md(h,e,t));y.useImperativeHandle(r,()=>({getPermissions(){return{permissions:a.modifiedData}},resetForm(){s({type:"ON_RESET"})},setFormAfterSubmit(){s({type:"ON_SUBMIT_SUCCEEDED"})}}));const u={...a,onChange:({target:{name:h,value:f}})=>s({type:"ON_CHANGE",keys:h.split("."),value:f==="empty__string_value"?"":f}),onChangeSelectAll:({target:{name:h,value:f}})=>s({type:"ON_CHANGE_SELECT_ALL",keys:h.split("."),value:f}),onSelectedAction:h=>s({type:"SELECT_ACTION",actionToSelect:h})};return i.jsx(Nt,{value:u,children:i.jsxs(S.Root,{gap:0,shadow:"filterShadow",hasRadius:!0,background:"neutral0",children:[i.jsx(S.Item,{col:7,xs:12,paddingTop:6,paddingBottom:6,paddingLeft:7,paddingRight:7,direction:"column",alignItems:"stretch",children:i.jsxs(x,{direction:"column",alignItems:"stretch",gap:6,children:[i.jsxs(x,{direction:"column",alignItems:"stretch",gap:2,children:[i.jsx(b,{variant:"delta",tag:"h2",children:n({id:j("Plugins.header.title"),defaultMessage:"Permissions"})}),i.jsx(b,{tag:"p",textColor:"neutral600",children:n({id:j("Plugins.header.description"),defaultMessage:"Only actions bound by a route are listed below."})})]}),i.jsx(iu,{})]})}),i.jsx(gd,{})]})})});sr.propTypes={permissions:_.object.isRequired,routes:_.object.isRequired};var ar=y.memo(sr);const ir=Sr().shape({name:Ne().required(qe.required.id),description:Ne().required(qe.required.id)}),uf=e=>Object.keys(e).reduce((t,r)=>{const n=e[r].controllers,a=Object.keys(n).reduce((s,o)=>(be(n[o])||(s[o]=n[o]),s),{});return be(a)||(t[r]={controllers:a}),t},{}),or=()=>{const{toggleNotification:e}=re(),{get:t}=Q(),{formatAPIError:r}=gt(j),[{data:n,isLoading:a,error:s,refetch:o},{data:c,isLoading:l,error:u,refetch:h}]=Jr([{queryKey:["users-permissions","permissions"],async queryFn(){const{data:{permissions:g}}=await t("/users-permissions/permissions");return g}},{queryKey:["users-permissions","routes"],async queryFn(){const{data:{routes:g}}=await t("/users-permissions/routes");return g}}]),f=async()=>{await Promise.all([o(),h()])};y.useEffect(()=>{s&&e({type:"danger",message:r(s)})},[e,s,r]),y.useEffect(()=>{u&&e({type:"danger",message:r(u)})},[e,u,r]);const d=a||l;return{permissions:n?uf(n):{},routes:c??{},getData:f,isLoading:d}},df=()=>{const{formatMessage:e}=E(),{toggleNotification:t}=re(),r=mt(),{isLoading:n,permissions:a,routes:s}=or(),{trackUsage:o}=vt(),c=y.useRef(),{post:l}=Q(),u=_e(f=>l("/users-permissions/roles",f),{onError(){t({type:"danger",message:e({id:"notification.error",defaultMessage:"An error occurred"})})},onSuccess(){o("didCreateRole"),t({type:"success",message:e({id:j("Settings.roles.created"),defaultMessage:"Role created"})}),r(-1)}}),h=async f=>{const d=c.current.getPermissions();await u.mutate({...f,...d,users:[]})};return i.jsxs(C.Main,{children:[i.jsx(C.Title,{children:e({id:"Settings.PageTitle",defaultMessage:"Settings - {name}"},{name:"Roles"})}),i.jsx(yt,{enableReinitialize:!0,initialValues:{name:"",description:""},onSubmit:h,validationSchema:ir,children:({handleSubmit:f,values:d,handleChange:g,errors:p})=>i.jsxs(bt,{noValidate:!0,onSubmit:f,children:[i.jsx(I.Header,{primaryAction:!n&&i.jsx($t,{type:"submit",loading:u.isLoading,startIcon:i.jsx(xt,{}),fullWidth:!0,children:e({id:"global.save",defaultMessage:"Save"})}),title:e({id:"Settings.roles.create.title",defaultMessage:"Create a role"}),subtitle:e({id:"Settings.roles.create.description",defaultMessage:"Define the rights given to the role"}),navigationAction:i.jsx(M,{display:{initial:"none",medium:"block"},children:i.jsx(_t,{fallback:".."})})}),i.jsx(I.Content,{children:i.jsxs(x,{background:"neutral0",direction:"column",alignItems:"stretch",gap:7,hasRadius:!0,paddingTop:6,paddingBottom:6,paddingLeft:7,paddingRight:7,shadow:"filterShadow",children:[i.jsxs(x,{direction:"column",alignItems:"stretch",children:[i.jsx(b,{variant:"delta",tag:"h2",children:e({id:j("EditPage.form.roles"),defaultMessage:"Role details"})}),i.jsxs(S.Root,{gap:4,children:[i.jsx(S.Item,{col:6,xs:12,direction:"column",alignItems:"stretch",children:i.jsxs(O.Root,{name:"name",error:p?.name?e({id:p.name,defaultMessage:"Name is required"}):!1,required:!0,children:[i.jsx(O.Label,{children:e({id:"global.name",defaultMessage:"Name"})}),i.jsx(Ct,{type:"text",value:d.name||"",onChange:g}),i.jsx(O.Error,{})]})}),i.jsx(S.Item,{col:6,xs:12,direction:"column",alignItems:"stretch",children:i.jsxs(O.Root,{name:"description",error:p?.description?e({id:p.description,defaultMessage:"Description is required"}):!1,required:!0,children:[i.jsx(O.Label,{children:e({id:"global.description",defaultMessage:"Description"})}),i.jsx(Ot,{value:d.description||"",onChange:g}),i.jsx(O.Error,{})]})})]})]}),!n&&i.jsx(ar,{ref:c,permissions:a,routes:s})]})})]})})]})},ff=()=>i.jsx(C.Protect,{permissions:w.createRole,children:i.jsx(df,{})}),hf=()=>{const{formatMessage:e}=E(),{toggleNotification:t}=re(),{params:{id:r}}=Pr("/settings/users-permissions/roles/:id"),{get:n}=Q(),{isLoading:a,routes:s}=or(),{data:o,isLoading:c,refetch:l}=At(["users-permissions","role",r],async()=>{const{data:{role:p}}=await n(`/users-permissions/roles/${r}`);return p}),u=y.useRef(),{put:h}=Q(),{formatAPIError:f}=gt(),d=_e(p=>h(`/users-permissions/roles/${r}`,p),{onError(p){t({type:"danger",message:f(p)})},async onSuccess(){t({type:"success",message:e({id:j("Settings.roles.created"),defaultMessage:"Role edited"})}),await l()}}),g=async p=>{const m=u.current.getPermissions();await d.mutate({...p,...m,users:[]})};return c?i.jsx(C.Loading,{}):i.jsxs(C.Main,{children:[i.jsx(C.Title,{children:e({id:"Settings.PageTitle",defaultMessage:"Settings - {name}"},{name:"Roles"})}),i.jsx(yt,{enableReinitialize:!0,initialValues:{name:o.name,description:o.description},onSubmit:g,validationSchema:ir,children:({handleSubmit:p,values:m,handleChange:v,errors:$})=>i.jsxs(bt,{noValidate:!0,onSubmit:p,children:[i.jsx(I.Header,{primaryAction:a?null:i.jsx($t,{disabled:o.code==="strapi-super-admin",type:"submit",loading:d.isLoading,startIcon:i.jsx(xt,{}),fullWidth:!0,children:e({id:"global.save",defaultMessage:"Save"})}),title:o.name,subtitle:o.description,navigationAction:i.jsx(M,{display:{initial:"none",medium:"block"},children:i.jsx(_t,{fallback:".."})})}),i.jsx(I.Content,{children:i.jsxs(x,{background:"neutral0",direction:"column",alignItems:"stretch",gap:7,hasRadius:!0,paddingTop:6,paddingBottom:6,paddingLeft:7,paddingRight:7,shadow:"filterShadow",children:[i.jsxs(x,{direction:"column",alignItems:"stretch",gap:4,children:[i.jsx(b,{variant:"delta",tag:"h2",children:e({id:j("EditPage.form.roles"),defaultMessage:"Role details"})}),i.jsxs(S.Root,{gap:4,children:[i.jsx(S.Item,{col:6,xs:12,direction:"column",alignItems:"stretch",children:i.jsxs(O.Root,{name:"name",error:$?.name?e({id:$.name,defaultMessage:"Name is required"}):!1,required:!0,children:[i.jsx(O.Label,{children:e({id:"global.name",defaultMessage:"Name"})}),i.jsx(Ct,{type:"text",value:m.name||"",onChange:v}),i.jsx(O.Error,{})]})}),i.jsx(S.Item,{col:6,xs:12,direction:"column",alignItems:"stretch",children:i.jsxs(O.Root,{name:"description",error:$?.description?e({id:$.description,defaultMessage:"Description is required"}):!1,required:!0,children:[i.jsx(O.Label,{children:e({id:"global.description",defaultMessage:"Description"})}),i.jsx(Ot,{value:m.description||"",onChange:v}),i.jsx(O.Error,{})]})})]})]}),!a&&i.jsx(ar,{ref:u,permissions:o.permissions,routes:s})]})})]})})]})},pf=()=>i.jsx(C.Protect,{permissions:w.updateRole,children:i.jsx(hf,{})}),gf=te(Er)`
  align-items: center;
  height: 3.2rem;
  width: 3.2rem;
  display: flex;
  justify-content: center;
  padding: ${({theme:e})=>`${e.spaces[2]}`};

  svg {
    height: 1.6rem;
    width: 1.6rem;

    path {
      fill: ${({theme:e})=>e.colors.neutral500};
    }
  }

  &:hover,
  &:focus {
    svg {
      path {
        fill: ${({theme:e})=>e.colors.neutral800};
      }
    }
  }
`,Ee=({sortedRoles:e,canDelete:t,canUpdate:r,setRoleToDelete:n,onDelete:a})=>{const{formatMessage:s}=E(),o=mt(),[c,l]=a,u=f=>t&&!["public","authenticated"].includes(f.type),h=f=>{n(f),l(!c)};return i.jsx(jr,{children:e?.map(f=>i.jsxs(St,{cursor:"pointer",onClick:()=>o(f.id.toString()),children:[i.jsx(Y,{width:"20%",children:i.jsx(b,{children:f.name})}),i.jsx(Y,{width:"50%",children:i.jsx(b,{children:f.description})}),i.jsx(Y,{width:"30%",children:i.jsx(b,{children:s({id:"Roles.RoleRow.user-count",defaultMessage:"{number, plural, =0 {# user} one {# user} other {# users}}"},{number:f.nb_users})})}),i.jsx(Y,{children:i.jsxs(x,{justifyContent:"end",onClick:d=>d.stopPropagation(),children:[r?i.jsx(gf,{tag:Pt,to:f.id.toString(),"aria-label":s({id:"app.component.table.edit",defaultMessage:"Edit {target}"},{target:`${f.name}`}),children:i.jsx(Rr,{})}):null,u(f)&&i.jsx(wr,{onClick:()=>h(f.id.toString()),variant:"ghost",label:s({id:"global.delete-target",defaultMessage:"Delete {target}"},{target:`${f.name}`}),children:i.jsx(Mr,{})})]})})]},f.name))})};Ee.defaultProps={canDelete:!1,canUpdate:!1};Ee.propTypes={onDelete:_.array.isRequired,setRoleToDelete:_.func.isRequired,sortedRoles:_.array.isRequired,canDelete:_.bool,canUpdate:_.bool};const mf=()=>{const{trackUsage:e}=vt(),{formatMessage:t,locale:r}=E(),{toggleNotification:n}=re(),{notifyStatus:a}=Tr(),[{query:s}]=Ir(),o=s?._q||"",[c,l]=y.useState(!1),[u,h]=y.useState(),{del:f,get:d}=Q(),{isLoading:g,allowedActions:{canRead:p,canDelete:m,canCreate:v,canUpdate:$}}=Lr({create:w.createRole,read:w.readRoles,update:w.updateRole,delete:w.deleteRole}),{isLoading:R,data:{roles:U},isFetching:L,refetch:D}=At("get-roles",()=>dr(n,t,a),{initialData:{},enabled:p}),{contains:Te}=Dr(r,{sensitivity:"base"}),Ie=Nr(r,{sensitivity:"base"}),cr=R||L||g,lr=()=>{l(!c)},ur=async(A,N,he)=>{try{await f(`/users-permissions/roles/${A}`)}catch{he({type:"danger",message:N({id:"notification.error",defaultMessage:"An error occured"})})}},dr=async(A,N,he)=>{try{const{data:X}=await d("/users-permissions/roles");return he("The roles have loaded successfully"),X}catch(X){throw A({type:"danger",message:N({id:"notification.error",defaultMessage:"An error occurred"})}),new Error(X)}},fr={roles:{id:j("Roles.empty"),defaultMessage:"You don't have any roles yet."},search:{id:j("Roles.empty.search"),defaultMessage:"No roles match the search."}},hr=t({id:"global.roles",defaultMessage:"Roles"}),pr=_e(A=>ur(A,t,n),{async onSuccess(){await D()}}),gr=async()=>{await pr.mutateAsync(u),l(!c)},W=(U||[]).filter(A=>Te(A.name,o)||Te(A.description,o)).sort((A,N)=>Ie.compare(A.name,N.name)||Ie.compare(A.description,N.description)),mr=o&&!W.length?"search":"roles",vr=4,yr=(U?.length||0)+1;return cr?i.jsx(C.Loading,{}):i.jsxs(C.Main,{children:[i.jsx(C.Title,{children:t({id:"Settings.PageTitle",defaultMessage:"Settings - {name}"},{name:hr})}),i.jsx(I.Header,{title:t({id:"global.roles",defaultMessage:"Roles"}),subtitle:t({id:"Settings.roles.list.description",defaultMessage:"List of roles"}),primaryAction:v?i.jsx(qr,{to:"new",tag:Pt,onClick:()=>e("willCreateRole"),startIcon:i.jsx(Hr,{}),size:"S",fullWidth:!0,children:t({id:j("List.button.roles"),defaultMessage:"Add new role"})}):null}),i.jsx(I.Action,{startActions:i.jsx(Yr,{label:t({id:"app.component.search.label",defaultMessage:"Search"})})}),i.jsxs(I.Content,{children:[!p&&i.jsx(C.NoPermissions,{}),p&&W&&W?.length?i.jsxs(Fr,{colCount:vr,rowCount:yr,children:[i.jsx(Br,{children:i.jsxs(St,{children:[i.jsx(Z,{children:i.jsx(b,{variant:"sigma",textColor:"neutral600",children:t({id:"global.name",defaultMessage:"Name"})})}),i.jsx(Z,{children:i.jsx(b,{variant:"sigma",textColor:"neutral600",children:t({id:"global.description",defaultMessage:"Description"})})}),i.jsx(Z,{children:i.jsx(b,{variant:"sigma",textColor:"neutral600",children:t({id:"global.users",defaultMessage:"Users"})})}),i.jsx(Z,{children:i.jsx(ht,{children:t({id:"global.actions",defaultMessage:"Actions"})})})]})}),i.jsx(Ee,{sortedRoles:W,canDelete:m,canUpdate:$,permissions:w,setRoleToDelete:h,onDelete:[c,l]})]}):i.jsx(Gr,{content:t(fr[mr])})]}),i.jsx(Ur.Root,{open:c,onOpenChange:lr,children:i.jsx(kr,{onConfirm:gr})})]})},vf=()=>i.jsx(C.Protect,{permissions:w.accessRoles,children:i.jsx(mf,{})}),Cf=()=>i.jsx(C.Protect,{permissions:w.accessRoles,children:i.jsxs(Kr,{children:[i.jsx(pe,{index:!0,element:i.jsx(vf,{})}),i.jsx(pe,{path:"new",element:i.jsx(ff,{})}),i.jsx(pe,{path:":id",element:i.jsx(pf,{})})]})});export{Cf as default};
