const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["AdminSeatInfo-Ch1bzjRd.js","strapi-D0ivxu6x.js","strapi-D6821bIJ.css","selectors-MEKBT33G.js","AIUsage-DmSx89zr.js"])))=>i.map(i=>d[i]);
import{r as h,a as L,j as e,co as m,d3 as Y,d4 as q,Z as x,d5 as J,o as k,aI as Q,cL as ee,d6 as te,c$ as v,T as b,I as u,z,H as y,d7 as ae,aY as ie,d8 as ne,d9 as se,da as oe,db as le,dc as de,dd as re,de as ce,df as ge,l as ue,dg as pe,dh as me,b as he,c9 as xe,di as fe,k as je,dj as w,bz as _,w as Se,P as B,L as O,y as Me,U as C,bW as V,bX as W,M as $}from"./strapi-D0ivxu6x.js";import{s as Ie}from"./selectors-MEKBT33G.js";const R=750,A=100,G=["image/jpeg","image/png","image/svg+xml"],be={id:"Settings.application.customization.modal.upload.error-format",defaultMessage:"Wrong format uploaded (accepted formats only: jpeg, jpg, png, svg)."},H={id:"Settings.application.customization.modal.upload.error-size",defaultMessage:"The file uploaded is too large (max dimension: {dimension}x{dimension}, max file size: {size}KB)"},K=async a=>{if(!G.includes(a.type))throw new E("File format",be);const i=await new Promise(l=>{const d=new FileReader;d.onload=()=>{const r=new Image;r.onload=()=>{l({width:r.width,height:r.height})},r.src=d.result},d.readAsDataURL(a)});if(!(i.width<=R&&i.height<=R))throw new E("File sizing",H);const n={ext:a.name.split(".").pop(),size:a.size/1e3,name:a.name,url:URL.createObjectURL(a),rawFile:a,width:i.width,height:i.height};if(!(n.size<=A))throw new E("File sizing",H);return n};class E extends Error{constructor(t,i,g){super(t,g),this.displayMessage=i}}const[ze,T]=te("LogoInput"),N=({canUpdate:a,customLogo:t,defaultLogo:i,hint:g,label:n,onChangeLogo:o})=>{const[l,d]=h.useState(),[r,f]=h.useState(),{formatMessage:c}=L(),M=()=>{d(void 0),f(void 0)};return e.jsx(m.Root,{open:!!r,onOpenChange:j=>{j===!1&&M()},children:e.jsxs(ze,{setLocalImage:d,localImage:l,goToStep:f,onClose:M,children:[e.jsx(Y,{label:n,selectedSlide:0,hint:g,previousLabel:"",nextLabel:"",onNext:()=>{},onPrevious:()=>{},secondaryLabel:t?.name||"logo.png",actions:e.jsxs(J,{children:[e.jsx(m.Trigger,{children:e.jsx(k,{disabled:!a,onClick:()=>f("upload"),label:c({id:"Settings.application.customization.carousel.change-action",defaultMessage:"Change logo"}),children:e.jsx(Q,{})})}),t?.url&&e.jsx(k,{disabled:!a,onClick:()=>o(null),label:c({id:"Settings.application.customization.carousel.reset-action",defaultMessage:"Reset logo"}),children:e.jsx(ee,{})})]}),children:e.jsx(q,{label:c({id:"Settings.application.customization.carousel-slide.label",defaultMessage:"Logo slide"}),children:e.jsx(x,{maxHeight:"40%",maxWidth:"40%",tag:"img",src:t?.url||i,alt:c({id:"Settings.application.customization.carousel.title",defaultMessage:"Logo"})})})}),e.jsxs(m.Content,{children:[e.jsx(m.Header,{children:e.jsx(m.Title,{children:c(r==="upload"?{id:"Settings.application.customization.modal.upload",defaultMessage:"Upload logo"}:{id:"Settings.application.customization.modal.pending",defaultMessage:"Pending logo"})})}),r==="upload"?e.jsx(Ce,{}):e.jsx(Re,{onChangeLogo:o})]})]})})},Ce=()=>{const{formatMessage:a}=L();return e.jsxs(v.Root,{variant:"simple",defaultValue:"computer",children:[e.jsx(x,{paddingLeft:8,paddingRight:8,children:e.jsxs(v.List,{"aria-label":a({id:"Settings.application.customization.modal.tab.label",defaultMessage:"How do you want to upload your assets?"}),children:[e.jsx(v.Trigger,{value:"computer",children:a({id:"Settings.application.customization.modal.upload.from-computer",defaultMessage:"From computer"})}),e.jsx(v.Trigger,{value:"url",children:a({id:"Settings.application.customization.modal.upload.from-url",defaultMessage:"From url"})})]})}),e.jsx(v.Content,{value:"computer",children:e.jsx(ve,{})}),e.jsx(v.Content,{value:"url",children:e.jsx(Le,{})})]})},Le=()=>{const{formatMessage:a}=L(),[t,i]=h.useState(""),[g,n]=h.useState(),{setLocalImage:o,goToStep:l,onClose:d}=T("URLForm"),r=c=>{i(c.target.value)},f=async c=>{c.preventDefault();const j=new FormData(c.target).get("logo-url");if(j)try{const p=await pe.get(j.toString(),{responseType:"blob",timeout:8e3}),I=new File([p.data],p.config.url??"",{type:p.headers["content-type"]}),S=await K(I);o(S),l("pending")}catch(p){if(p instanceof me)n(a({id:"Settings.application.customization.modal.upload.error-network",defaultMessage:"Network error"}));else if(p instanceof E)n(a(p.displayMessage,{size:A,dimension:R}));else throw p}};return e.jsxs("form",{onSubmit:f,children:[e.jsx(x,{paddingLeft:8,paddingRight:8,paddingTop:6,paddingBottom:6,children:e.jsxs(y.Root,{error:g,name:"logo-url",children:[e.jsx(y.Label,{children:a({id:"Settings.application.customization.modal.upload.from-url.input-label",defaultMessage:"URL"})}),e.jsx(ie,{type:"url",onChange:r,value:t}),e.jsx(y.Error,{})]})}),e.jsxs(m.Footer,{children:[e.jsx(z,{onClick:d,variant:"tertiary",children:a({id:"app.components.Button.cancel",defaultMessage:"Cancel"})}),e.jsx(z,{type:"submit",children:a({id:"Settings.application.customization.modal.upload.next",defaultMessage:"Next"})})]})]})},ve=()=>{const{formatMessage:a}=L(),[t,i]=h.useState(!1),[g,n]=h.useState(),o=h.useRef(null),l=h.useId(),{setLocalImage:d,goToStep:r,onClose:f}=T("ComputerForm"),c=()=>{i(!0)},M=()=>{i(!1)},j=I=>{I.preventDefault(),o.current.click()},p=async()=>{if(M(),!o.current.files)return;const[I]=o.current.files;try{const S=await K(I);d(S),r("pending")}catch(S){if(S instanceof E)n(a(S.displayMessage,{size:A,dimension:R})),o.current.focus();else throw S}};return e.jsxs(e.Fragment,{children:[e.jsx("form",{children:e.jsx(x,{paddingLeft:8,paddingRight:8,paddingTop:6,paddingBottom:6,children:e.jsx(y.Root,{name:l,error:g,children:e.jsxs(b,{direction:"column",alignItems:"stretch",gap:2,children:[e.jsxs(b,{paddingTop:9,paddingBottom:7,hasRadius:!0,justifyContent:"center",direction:"column",background:t?"primary100":"neutral100",borderColor:t?"primary500":g?"danger600":"neutral300",borderStyle:"dashed",borderWidth:"1px",position:"relative",onDragEnter:c,onDragLeave:M,children:[e.jsx(ae,{fill:"primary600",width:"6rem",height:"6rem","aria-hidden":!0}),e.jsx(x,{paddingTop:3,paddingBottom:5,children:e.jsx(u,{variant:"delta",tag:"label",htmlFor:l,children:a({id:"Settings.application.customization.modal.upload.drag-drop",defaultMessage:"Drag and Drop here or"})})}),e.jsx(x,{position:"relative",children:e.jsx(ye,{accept:G.join(", "),type:"file",name:"files",tabIndex:-1,onChange:p,ref:o,id:l})}),e.jsx(z,{type:"button",onClick:j,children:a({id:"Settings.application.customization.modal.upload.cta.browse",defaultMessage:"Browse files"})}),e.jsx(x,{paddingTop:6,children:e.jsx(u,{variant:"pi",textColor:"neutral600",children:a({id:"Settings.application.customization.modal.upload.file-validation",defaultMessage:"Max dimension: {dimension}x{dimension}, Max size: {size}KB"},{size:A,dimension:R})})})]}),e.jsx(y.Error,{})]})})})}),e.jsx(m.Footer,{children:e.jsx(z,{onClick:f,variant:"tertiary",children:a({id:"app.components.Button.cancel",defaultMessage:"Cancel"})})})]})},ye=ue(y.Input)`
  opacity: 0;
  position: absolute;
  top: 0;
  bottom: 0;
  left: 0;
  right: 0;
  z-index: 1;
`,Re=({onChangeLogo:a})=>{const{formatMessage:t}=L(),{localImage:i,setLocalImage:g,goToStep:n,onClose:o}=T("PendingLogoDialog"),l=()=>{g(void 0),n("upload")},d=()=>{i&&a(i),o()};return e.jsxs(e.Fragment,{children:[e.jsx(m.Body,{children:e.jsxs(x,{paddingLeft:8,paddingRight:8,paddingTop:6,paddingBottom:6,children:[e.jsxs(b,{justifyContent:"space-between",paddingBottom:6,children:[e.jsxs(b,{direction:"column",alignItems:"flex-start",children:[e.jsx(u,{variant:"pi",fontWeight:"bold",children:t({id:"Settings.application.customization.modal.pending.title",defaultMessage:"Logo ready to upload"})}),e.jsx(u,{variant:"pi",textColor:"neutral500",children:t({id:"Settings.application.customization.modal.pending.subtitle",defaultMessage:"Manage the chosen logo before uploading it"})})]}),e.jsx(z,{onClick:l,variant:"secondary",children:t({id:"Settings.application.customization.modal.pending.choose-another",defaultMessage:"Choose another logo"})})]}),e.jsx(x,{maxWidth:"18rem",children:i?.url?e.jsx(we,{asset:i}):null})]})}),e.jsxs(m.Footer,{children:[e.jsx(m.Close,{children:e.jsx(z,{onClick:o,variant:"tertiary",children:t({id:"Settings.application.customization.modal.cancel",defaultMessage:"Cancel"})})}),e.jsx(z,{onClick:d,children:t({id:"Settings.application.customization.modal.pending.upload",defaultMessage:"Upload logo"})})]})]})},we=({asset:a})=>{const{formatMessage:t}=L();return e.jsxs(ne,{children:[e.jsx(se,{children:e.jsx(oe,{size:"S",src:a.url})}),e.jsxs(le,{children:[e.jsxs(de,{children:[e.jsx(re,{children:a.name}),e.jsx(ce,{children:`${a.ext?.toUpperCase()} - ${a.width}✕${a.height}`})]}),e.jsx(ge,{children:t({id:"Settings.application.customization.modal.pending.card-badge",defaultMessage:"image"})})]})]})},Ee=()=>null,Ae=()=>null,De=()=>{const{trackUsage:a}=he(),{formatMessage:t}=L();xe();const{logos:i,updateProjectSettings:g}=fe("ApplicationInfoPage"),[n,o]=h.useState({menu:i.menu,auth:i.auth}),{settings:l}=je(Ie),d=w("ApplicationInfoPage",s=>s.communityEdition),r=w("ApplicationInfoPage",s=>s.latestStrapiReleaseTag),f=w("ApplicationInfoPage",s=>s.nodeVersion),c=w("ApplicationInfoPage",s=>s.shouldUpdateStrapi),M=w("ApplicationInfoPage",s=>s.strapiVersion),j=_(Ee,async()=>(await $(async()=>{const{AdminSeatInfoEE:s}=await import("./AdminSeatInfo-Ch1bzjRd.js");return{AdminSeatInfoEE:s}},__vite__mapDeps([0,1,2,3]))).AdminSeatInfoEE),p=window.strapi.ai?.enabled!==!1,I=_(Ae,async()=>(await $(async()=>{const{AIUsage:s}=await import("./AIUsage-DmSx89zr.js");return{AIUsage:s}},__vite__mapDeps([4,1,2]))).AIUsage,{enabled:p}),{allowedActions:{canRead:S,canUpdate:F}}=Se(l?l["project-settings"]:{}),Z=s=>{s.preventDefault(),g({authLogo:n.auth.custom??null,menuLogo:n.menu.custom??null})},D=s=>P=>{P===null&&a("didClickResetLogo",{logo:s}),o(U=>({...U,[s]:{...U[s],custom:P}}))};if(h.useEffect(()=>{o({menu:i.menu,auth:i.auth})},[i]),!j||!I)return null;const X=n.auth.custom===i.auth.custom&&n.menu.custom===i.menu.custom;return e.jsxs(e.Fragment,{children:[e.jsx(B.Title,{children:t({id:"Settings.PageTitle",defaultMessage:"Settings - {name}"},{name:t({id:"Settings.application.header",defaultMessage:"Application"})})}),e.jsx(B.Main,{children:e.jsxs("form",{onSubmit:Z,children:[e.jsx(O.Header,{title:t({id:"Settings.application.title",defaultMessage:"Overview"}),subtitle:t({id:"Settings.application.description",defaultMessage:"Administration panel’s global information"}),primaryAction:F&&e.jsx(z,{disabled:X,type:"submit",startIcon:e.jsx(Me,{}),fullWidth:!0,children:t({id:"global.save",defaultMessage:"Save"})})}),e.jsx(O.Content,{children:e.jsxs(b,{direction:"column",alignItems:"stretch",gap:6,children:[e.jsxs(b,{direction:"column",alignItems:"stretch",gap:4,hasRadius:!0,background:"neutral0",shadow:"tableShadow",paddingTop:6,paddingBottom:6,paddingRight:7,paddingLeft:7,children:[e.jsx(u,{variant:"delta",tag:"h3",children:t({id:"global.details",defaultMessage:"Details"})}),e.jsxs(C.Root,{gap:5,tag:"dl",children:[e.jsxs(C.Item,{col:6,xs:12,direction:"column",alignItems:"start",children:[e.jsx(u,{variant:"sigma",textColor:"neutral600",tag:"dt",children:t({id:"Settings.application.strapiVersion",defaultMessage:"strapi version"})}),e.jsxs(b,{gap:3,direction:"column",alignItems:"start",tag:"dd",children:[e.jsxs(u,{children:["v",M]}),c&&e.jsx(V,{href:`https://github.com/strapi/strapi/releases/tag/${r}`,endIcon:e.jsx(W,{}),children:t({id:"Settings.application.link-upgrade",defaultMessage:"Upgrade your admin panel"})})]})]}),e.jsxs(C.Item,{col:6,xs:12,direction:"column",alignItems:"start",children:[e.jsx(u,{variant:"sigma",textColor:"neutral600",tag:"dt",children:t({id:"Settings.application.edition-title",defaultMessage:"current edition"})}),e.jsxs(b,{gap:3,direction:"column",alignItems:"start",tag:"dd",children:[e.jsx(u,{children:t({id:"Settings.application.ee-or-ce",defaultMessage:"{communityEdition, select, true {Community Edition} other {Enterprise Edition}}"},{communityEdition:d})}),e.jsx(V,{href:"https://strapi.io/pricing-self-hosted",endIcon:e.jsx(W,{}),children:t({id:"Settings.application.link-pricing",defaultMessage:"See all pricing plans"})})]})]}),e.jsxs(C.Item,{col:6,xs:12,direction:"column",alignItems:"start",children:[e.jsx(u,{variant:"sigma",textColor:"neutral600",tag:"dt",children:t({id:"Settings.application.node-version",defaultMessage:"node version"})}),e.jsx(u,{tag:"dd",children:f})]}),e.jsx(j,{}),e.jsx(I,{})]})]}),S&&e.jsxs(x,{hasRadius:!0,background:"neutral0",shadow:"tableShadow",paddingTop:6,paddingBottom:6,paddingRight:7,paddingLeft:7,children:[e.jsx(u,{variant:"delta",tag:"h3",children:t({id:"Settings.application.customization",defaultMessage:"Customization"})}),e.jsx(u,{variant:"pi",textColor:"neutral600",children:t({id:"Settings.application.customization.size-details",defaultMessage:"Max dimension: {dimension}×{dimension}, Max file size: {size}KB"},{dimension:R,size:A})}),e.jsxs(C.Root,{paddingTop:4,gap:4,children:[e.jsx(C.Item,{col:6,xs:12,direction:"column",alignItems:"stretch",children:e.jsx(N,{canUpdate:F,customLogo:n.menu.custom,defaultLogo:n.menu.default,hint:t({id:"Settings.application.customization.menu-logo.carousel-hint",defaultMessage:"Replace the logo in the main navigation"}),label:t({id:"Settings.application.customization.carousel.menu-logo.title",defaultMessage:"Menu logo"}),onChangeLogo:D("menu")})}),e.jsx(C.Item,{col:6,xs:12,direction:"column",alignItems:"stretch",children:e.jsx(N,{canUpdate:F,customLogo:n.auth.custom,defaultLogo:n.auth.default,hint:t({id:"Settings.application.customization.auth-logo.carousel-hint",defaultMessage:"Replace the logo in the authentication pages"}),label:t({id:"Settings.application.customization.carousel.auth-logo.title",defaultMessage:"Auth logo"}),onChangeLogo:D("auth")})})]})]})]})})]})})]})};export{De as ApplicationInfoPage};
