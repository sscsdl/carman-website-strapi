import{a as u,u as m,j as t,b as h,Q as j,S as f,W as L,X as v,Y as n,I as c,Z as y,o as C,a2 as k,ag as A,l as D,ah as S}from"./strapi-D0ivxu6x.js";import{W as d}from"./WidgetHelpers-D_vu1lKI.js";import{R as E}from"./RelativeTime-BX3f58ib.js";import{u as M,g as R}from"./getActionTypesDefaultMessages-euS0cRUh.js";const b=D(E)`
  display: inline-block;

  &::first-letter {
    text-transform: uppercase;
  }
`,w=({items:a})=>{const{formatMessage:i}=u(),{trackUsage:s}=h(),l=j(),o=e=>`/settings/audit-logs?pageSize=${S}&page=1&sort=date:DESC&id=${e.id}`,p=e=>()=>{s("willOpenAuditLogDetailsFromHome");const r=o(e);l(r)};return t.jsx(f,{colCount:4,rowCount:a?.length??0,children:t.jsx(L,{children:a?.map(e=>{const r=i({id:`Settings.permissions.auditLogs.${e.action}`,defaultMessage:R(e.action)},{model:e.payload.model??""}),g=e.user?.displayName??"-";return t.jsxs(v,{onClick:p(e),cursor:"pointer",children:[t.jsx(n,{children:t.jsx(c,{title:r,variant:"omega",textColor:"neutral800",children:r})}),t.jsx(n,{children:t.jsx(c,{variant:"omega",textColor:"neutral800",children:t.jsx(b,{timestamp:new Date(e.date)})})}),t.jsx(n,{children:t.jsx(c,{title:g,variant:"omega",textColor:"neutral800",children:g})}),t.jsx(n,{onClick:x=>x.stopPropagation(),children:t.jsx(y,{display:"inline-block",children:t.jsx(C,{tag:k,to:o(e),onClick:()=>s("willOpenAuditLogDetailsFromHome"),label:i({id:"global.details",defaultMessage:"Details"}),variant:"ghost",children:t.jsx(A,{})})})})]},`lastActivity_auditLog_${e.id}`)})})})},$=()=>{const{formatMessage:a}=u(),[{query:i}]=m(),{data:s,isLoading:l,error:o}=M({...i,page:1,pageSize:4,sort:"date:DESC"},{refetchOnMountOrArgChange:!0});return l?t.jsx(d.Loading,{}):o||!s?.results?t.jsx(d.Error,{}):s.results.length===0?t.jsx(d.NoData,{children:a({id:"widget.last-activity.no-activity",defaultMessage:"No activity"})}):t.jsx(w,{items:s.results??[]})};export{$ as AuditLogsWidget};
